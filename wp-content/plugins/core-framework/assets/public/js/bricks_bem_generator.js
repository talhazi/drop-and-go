"use strict";var _a;{class VUE_APP{static generateId(){return(Math.random()+1).toString(36).slice(-6)}constructor(e){this.getAppData=e}get state(){var e,t,n;return null===(n=null===(t=null===(e=this.getAppData())||void 0===e?void 0:e.config)||void 0===t?void 0:t.globalProperties)||void 0===n?void 0:n.$_state}getElements(){return[...this.state.content,...this.state.header,...this.state.footer]}getElementById(e){return this.getElements().find(t=>t.id===e)}getElementLabel(e){if(e)return e.replace(/\([^)]*\)/g,"").replace(/\[[^\]]*]/g,"").replace(/[^a-zA-z0-9-_ ]/g,"").replace(/\s+/g,"-").trim().toLowerCase()}addClass(e,t){var n;let s=this.getElementById(t);if(!s)return;let o=null===(n=null==s?void 0:s.settings)||void 0===n?void 0:n._cssGlobalClasses,a=!1,r=VUE_APP.generateId();if(this.state.globalClasses.forEach(t=>{t.name===e?(a=!0,r=t.id):t.id===r&&(r=VUE_APP.generateId())}),!a){const t={id:r,name:e,settings:[]};this.state.globalClasses.push(t)}return o||(s.settings||(s.settings={}),s.settings._cssGlobalClasses=[],o=s.settings._cssGlobalClasses),(null==o?void 0:o.includes(r))||o.push(r),!0}getElementTree(e){const t=this.getElementById(e);if(!t)return null;const n={id:t.id,name:t.label||t.name,bemName:this.getElementLabel(t.label||t.name),rootName:this.getElementLabel(t.label||t.name),isRoot:!0,children:[]};return t.children&&Array.isArray(t.children)&&t.children.forEach(e=>{const t=this.getElementTree(e);t&&(t.isRoot=!1,t.rootName=n.rootName,n.children.push(t))}),n}renderTree(e){const t=e.isRoot,n=e.rootName,s=t?e.bemName:`${n}__${e.bemName}`;let o=`\n                <div class="bem-tree-item" data-element-id="${e.id}">\n                    <span class="label-inline">\n                        <span class="element-label--label">Label</span>\n                        <span class="element-name">${e.name}</span>\n                    </span>\n                    <input \n                        type="text" \n                        class="bem-name-input" \n                        value="${s}" \n                       data-is-root="${t}"\n                       data-root-name="${n}"\n                   />\n                </div>\n            `;return e.children.length&&(o+='<div class="bem-tree-children">',e.children.forEach(e=>{e.rootName=n,o+=this.renderTree(e)}),o+="</div>"),o}showBemPopup(e){var t,n,s;const o=document.querySelector(".bem-popup-wrapper"),a=this.getElementTree(e);if(o&&o.remove(),!a)return;const r=document.createElement("div"),l=document.createElement("div"),i=document.createElement("div");r.className="bem-popup-wrapper",l.className="bem-popup-glow",i.className="bem-popup",i.innerHTML='\n                <div class="bem-header">\n                    <span class="bem-header--svg">\n                    <svg \n                        id="b" \n                        xmlns="http://www.w3.org/2000/svg" \n                        viewBox="0 0 31.82 24.84"\n                    >\n                    <defs>\n                        <linearGradient id="e" x1="3.77" y1="7.44" x2="31.03" y2="24.04" \n                            gradientTransform="translate(0 26) scale(1 -1)" \n                            gradientUnits="userSpaceOnUse"\n                        >\n                            <stop offset="0" stop-color="#5c68f9"></stop>\n                            <stop offset="1" stop-color="#8e97fe"></stop>\n                        </linearGradient>\n                        <linearGradient id="f" x1="8.16" y1=".31" x2="13.63" y2="17.26" \n                            gradientTransform="translate(0 26) scale(1 -1)" \n                            gradientUnits="userSpaceOnUse"\n                        >\n                            <stop offset="0" stop-color="#5c68f9" stop-opacity="0"></stop>\n                            <stop offset=".08" stop-color="#5561f4" stop-opacity=".1"></stop>\n                            <stop offset=".32" stop-color="#434ce6" stop-opacity=".42"></stop>\n                            <stop offset=".55" stop-color="#343cdc" stop-opacity=".67"></stop>\n                            <stop offset=".74" stop-color="#2930d4" stop-opacity=".85"></stop>\n                            <stop offset=".9" stop-color="#2329cf" stop-opacity=".96"></stop>\n                            <stop offset="1" stop-color="#2127ce"></stop>\n                        </linearGradient>\n                    </defs>\n                    <g id="c">\n                        <g id="d">\n                            <rect x="18.78" y="10.68" width="13.03" height="7.07" style="fill:#a4a4a4;"></rect>\n                            <path d="m12.42,0C5.56,0,0,5.56,0,12.42h0c0,6.86,5.56,12.42,12.42,12.42h6.37v-7.07h-6.37c-2.95,0-5.35-2.39-5.35-5.35h0c0-2.95,2.39-5.35,5.35-5.35h19.4V0H12.42Z" style="fill:#bcbcbc;"></path>\n                            <path d="m7.07,12.42h0c0-1.23.43-2.35,1.13-3.25h-.02L.74,16.6c1.72,4.79,6.3,8.23,11.68,8.23h6.37v-7.07h-6.37c-2.95,0-5.35-2.39-5.35-5.35h0Z" style="fill:#919191;"></path>\n                        </g>\n                    </g>\n                </svg>\n                    </span>\n                    <h3>BEM Class Generator</h3>\n                    <button class="bem-close">âœ•</button>\n                </div>\n                <div class="bem-content">\n                    <div class="bem-section">\n                        <div class="bem-tree"></div>\n                    </div>\n                </div>\n                <div class="bem-footer">\n                    <button class="bem-button secondary bem-cancel">Cancel</button>\n                    <button class="bem-button bem-apply">Apply Classes</button>\n                </div>\n            ',r.appendChild(l),r.appendChild(i),document.body.appendChild(r);const c=i.querySelector(".bem-header"),d=this.initDragging(c,r),p=i.querySelector(".bem-tree");p.innerHTML=this.renderTree(a),p.addEventListener("input",e=>{const t=e.target;if(null==t?void 0:t.classList.contains("bem-name-input")){if("true"===t.dataset.isRoot){const e=t.value;p.querySelectorAll('.bem-name-input:not([data-is-root="true"])').forEach(t=>{const n=t.value.split("__").pop();t.value=`${e}__${n}`})}}});const m=()=>{d(),r.remove()};null===(t=i.querySelector(".bem-close"))||void 0===t||t.addEventListener("click",m),null===(n=i.querySelector(".bem-cancel"))||void 0===n||n.addEventListener("click",m),null===(s=i.querySelector(".bem-apply"))||void 0===s||s.addEventListener("click",()=>{const e=null==p?void 0:p.querySelectorAll(".bem-tree-item");null==e||e.forEach(e=>{const t=e.dataset.elementId,n=e.querySelector(".bem-name-input").value;console.log(n,t),t&&this.addClass(n,t)}),m(),this.state.updating=Date.now()})}addBemButton(e){const t=this,n=e.querySelector(".actions"),s=e.querySelector(".title");if(!n&&!s)return;if(n){if(n.querySelector(".bem-generator"))return}else if(null==s?void 0:s.querySelector(".bem-generator"))return;const o=document.createElement("span");if(o.innerHTML='\n                <svg \n                    id="b" \n                    xmlns="http://www.w3.org/2000/svg" \n                    viewBox="0 0 31.82 24.84"\n                >\n                    <defs>\n                        <linearGradient id="e" x1="3.77" y1="7.44" x2="31.03" y2="24.04" gradientTransform="translate(0 26) scale(1 -1)" gradientUnits="userSpaceOnUse">\n                            <stop offset="0" stop-color="#5c68f9"></stop>\n                            <stop offset="1" stop-color="#8e97fe"></stop>\n                        </linearGradient>\n                        <linearGradient id="f" x1="8.16" y1=".31" x2="13.63" y2="17.26" gradientTransform="translate(0 26) scale(1 -1)" gradientUnits="userSpaceOnUse">\n                            <stop offset="0" stop-color="#5c68f9" stop-opacity="0"></stop>\n                            <stop offset=".08" stop-color="#5561f4" stop-opacity=".1"></stop>\n                            <stop offset=".32" stop-color="#434ce6" stop-opacity=".42"></stop>\n                            <stop offset=".55" stop-color="#343cdc" stop-opacity=".67"></stop>\n                            <stop offset=".74" stop-color="#2930d4" stop-opacity=".85"></stop>\n                            <stop offset=".9" stop-color="#2329cf" stop-opacity=".96"></stop>\n                            <stop offset="1" stop-color="#2127ce"></stop>\n                        </linearGradient>\n                    </defs>\n                    <g id="c">\n                        <g id="d">\n                            <rect x="18.78" y="10.68" width="13.03" height="7.07" style="fill:#fa5e5e;"></rect>\n                            <path d="m12.42,0C5.56,0,0,5.56,0,12.42h0c0,6.86,5.56,12.42,12.42,12.42h6.37v-7.07h-6.37c-2.95,0-5.35-2.39-5.35-5.35h0c0-2.95,2.39-5.35,5.35-5.35h19.4V0H12.42Z" style="fill:#7d87fc;"></path>\n                            path d="m7.07,12.42h0c0-1.23.43-2.35,1.13-3.25h-.02L.74,16.6c1.72,4.79,6.3,8.23,11.68,8.23h6.37v-7.07h-6.37c-2.95,0-5.35-2.39-5.35-5.35h0Z" style="fill:#424ae1;"></path>\n                        </g>\n                    </g>\n                </svg>\n            ',o.classList.add("bricks-svg-wrapper","bem-generator"),o.setAttribute("title","Add BEM Classes"),o.addEventListener("click",n=>{var s;n.preventDefault(),n.stopPropagation();const o=null===(s=null==e?void 0:e.closest(".bricks-draggable-item"))||void 0===s?void 0:s.getAttribute("data-id");o&&t.showBemPopup(o)}),n){const e=document.createElement("li");e.classList.add("action","bem"),e.style.width="22px",e.append(o),n.append(e)}else if(s){const e=s.querySelector(".icon");e&&e.insertAdjacentElement("afterend",o)}}applyBemButtomToPanelElements(){const e=this;document.querySelectorAll(".structure-item").forEach(this.addBemButton.bind(e));const t=new MutationObserver(t=>{t.forEach(t=>{t.addedNodes.forEach(t=>{t instanceof HTMLElement&&(t.classList.contains("structure-item")&&this.addBemButton.bind(e,t)(),t.querySelectorAll&&t.querySelectorAll(".structure-item").forEach(t=>{this.addBemButton.bind(e,t)()}))})})}),n=document.querySelector("#bricks-structure");n&&t.observe(n,{childList:!0,subtree:!0})}initDragging(e,t){let n,s,o=!1,a=0,r=0,l=0,i=0;function c(t){const n=t.target;n.classList.contains("bem-close")||n.closest("svg")||(a=t.clientX-l,r=t.clientY-i,o=!0,e.style.cursor="grabbing")}function d(e){o&&(e.preventDefault(),n=e.clientX-a,s=e.clientY-r,l=n,i=s,t.style.transform=`translate(calc(-50% + ${n}px), calc(-50% + ${s}px))`)}function p(){o=!1,e.style.cursor="move"}return e.addEventListener("mousedown",c),document.addEventListener("mousemove",d),document.addEventListener("mouseup",p),()=>{e.removeEventListener("mousedown",c),document.removeEventListener("mousemove",d),document.removeEventListener("mouseup",p)}}}if(null===(_a=null===window||void 0===window?void 0:window.core_framework_connector)||void 0===_a?void 0:_a.bricks_bem_generator){const e=()=>{var e;return null===(e=null===document||void 0===document?void 0:document.querySelector(".brx-body"))||void 0===e?void 0:e.__vue_app__},t=new VUE_APP(e),n=setInterval(()=>{e()&&(clearInterval(n),t.applyBemButtomToPanelElements())},500)}}