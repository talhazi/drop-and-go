function xDoMediaPlayer(){function e(e,t,r){if(setTimeout(()=>{let t=e.dataset.xId,r=document.querySelector(".xmp-settings-menu-items[data-x-player-id='"+t+"']")?document.querySelector(".xmp-settings-menu-items[data-x-player-id='"+t+"']"):e.querySelector(".xmp-settings-menu-items");if(r){let a=r.querySelector("media-menu.xmp-accessibility-menu"),i=a?a.querySelector(".xmp-menu-checkbox"):null,l=e.querySelector("media-announcer");i&&i.addEventListener("click",function t(r){(void 0===r.code||"Enter"===r.code||"Space"===r.code)&&("false"===i.getAttribute("aria-pressed")?(i.setAttribute("aria-pressed","true"),e.querySelector(".xmp-media-features")&&!e.querySelector("media-announcer")&&e.querySelector(".xmp-media-features").appendChild(l)):(i.setAttribute("aria-pressed","false"),l&&l.remove()))});let o=r.querySelector(".xmp-loop-menu-section .xmp-menu-checkbox");o&&(o.addEventListener("click",function t(r){(void 0===r.code||"Enter"===r.code||"Space"===r.code)&&("false"===o.getAttribute("aria-pressed")?(o.setAttribute("aria-pressed","true"),e.loop=!0):(o.setAttribute("aria-pressed","false"),e.loop=!1))}),e.loop&&o.setAttribute("aria-pressed","true"))}let n=e.querySelectorAll("media-menu");n.forEach(e=>{let t=e.querySelectorAll("media-menu-items");e.addEventListener("close",e=>{t.forEach(e=>{setTimeout(()=>{e.hasAttribute("data-keyboard")&&(e.removeAttribute("data-keyboard"),e.removeAttribute("role"))},50)})})})},200),e.hasAttribute("data-iphone")&&t.fullscreenFallBack&&"none"!==t.fullscreenFallBack&&!e.closest(".splide__slide")){let a=0;function i(){document.body.style.position="",document.body.style.top="",document.body.style.width="",e.removeAttribute("data-x-fullscreen-fallback-active"),e.dispatchEvent(new Event("x_media_player_fullscreen_fallback_inactive")),e.dispatchEvent(new Event("x_fullscreen_change")),window.scrollTo({top:a,behavior:"instant"})}e.addEventListener("click",function(r){e.hasAttribute("data-x-fullscreen-fallback")&&r.target.closest("media-fullscreen-button")&&function r(l){if(l&&l.target.closest("media-fullscreen-button")){if(e.hasAttribute("data-x-fullscreen-fallback"))e.hasAttribute("data-x-fullscreen-fallback-active")?i():("full_window"===t.fullscreenFallBack||e.provider?.type==="youtube")&&(a=window.scrollY,document.body.style.position="fixed",document.body.style.top="-"+a+"px",document.body.style.width="100%",e.setAttribute("data-x-fullscreen-fallback-active",""),e.dispatchEvent(new Event("x_media_player_fullscreen_fallback_active")),e.dispatchEvent(new Event("x_fullscreen_change")));else if(e.hasAttribute("data-x-fullscreen-fallback-active")||e.hasAttribute("data-fullscreen")){i();try{e.exitFullscreen()}catch(o){console.log(o)}}else try{e.enterFullscreen()}catch(n){console.log(n)}}}(r)})}if(e.querySelectorAll(".xmp-next").forEach(e=>{function t(e){if(null==e.code||"Enter"===e.code||"Space"===e.code){let t=[],a=r.querySelectorAll(".brxe-xmediaplaylist");a.forEach((e,r)=>{e.hasAttribute("data-x-item-active")&&(r<a.length-1?t.push(a[r+1]):r===a.length-1&&t.push(a[0]))}),0!==t.length&&setTimeout(()=>{t[0].click()},10)}}e.addEventListener("pointerdown",t),e.addEventListener("keydown",t)}),e.querySelectorAll(".xmp-previous").forEach(e=>{function t(e){if(null==e.code||"Enter"===e.code||"Space"===e.code){let t=[],a=r.querySelectorAll(".brxe-xmediaplaylist");a.forEach((e,r)=>{e.hasAttribute("data-x-item-active")&&(0===r?t.push(a[a.length-1]):t.push(a[r-1]))}),0!==t.length&&setTimeout(()=>{t[0].click()},10)}}e.addEventListener("pointerdown",t),e.addEventListener("keydown",t)}),e.querySelector(".xmp-speed-menu-section")&&e.subscribe(({canSetPlaybackRate:t})=>{t?e.querySelector(".xmp-speed-menu-section").style.display="block":e.querySelector(".xmp-speed-menu-section").style.display="none"}),!document.querySelector("body > .brx-body.iframe")&&e.querySelector(".xmp-download")){let l=t=>{let r=t?.dataset?.xDownloadSource||"source",a=e.dataset?.xDownload||"",i=!1;if("download-option"===r){let l=t?.dataset?.xDownloadOptionId,o=e.dataset?.xDownloads;if(l&&o)try{let n=JSON.parse(o),s=n.find(e=>e.id===l);s&&s.url&&""!==s.url.trim()&&(i=!0)}catch(d){}}else if(a||e.currentSrc||e.src)i=!0;else{let u=e.querySelector("video, audio");u&&(u.currentSrc||u.src)&&(i=!0)}i?t.setAttribute("data-x-has-url",""):t.removeAttribute("data-x-has-url")};e.querySelectorAll(".xmp-download").forEach(t=>{if(t.dataset.xmpDownloadBound)return;l(t),t.updateVisibility=()=>l(t);let r=!1,a=async a=>{let i=a?.currentTarget||t;if(r)return;let l=e.provider?e.provider.type:null;if("audio"===l){r=!0;try{let o=i?.dataset?.xDownloadSource||"source",n=e.dataset?.xDownload||"",s=e=>e&&"string"==typeof e?e.replace(/[\\/:*?"<>|]/g,"").replace(/\s+/g," ").trim().substring(0,255):"",d="",u="";if("download-option"===o){let c=i?.dataset?.xDownloadOptionId,p=e.dataset?.xDownloads;if(c&&p)try{let m=JSON.parse(p);if(Array.isArray(m)){let y=m.find(e=>e&&e.id===c);y&&"string"==typeof y.url&&(d=y.url,y.title&&"string"==typeof y.title&&(u=s(y.title)))}}catch(f){}}if(!d&&(n?d=n:e.currentSrc?d=e.currentSrc:e.src&&"string"==typeof e.src&&(d=e.src)),!d){let b=e.querySelector("video, audio");b&&(d=b.currentSrc||b.src||"")}if(!d||"about:blank"===d||!(d=(e=>{if(!e||"string"!=typeof e)return null;let t=e.trim();if(!t)return null;try{let r=new URL(t,window.location.href),a=r.protocol.toLowerCase();if(!["http:","https:"].includes(a))return null;return r.href}catch(i){return null}})(d)))return;let $="media",x="",g="";try{let h=new URL(d,window.location.href),v=h.pathname,A=v.substring(v.lastIndexOf("/")+1);try{x=decodeURIComponent(A)}catch(_){x=A}}catch(S){}if(x){let w=x.indexOf("?");-1!==w&&(x=x.substring(0,w));let E=x.lastIndexOf(".");E>0&&E<x.length-1&&(g=x.substring(E))}let k="";u&&(k=s(u));let q="string"==typeof e.artist?s(e.artist):"",L="string"==typeof e.title?s(e.title):"",C=[];if(q&&C.push(q),L&&C.push(L),k)$=k;else if(C.length){let P=s(C.join(" - "));P&&($=P)}else x&&($=s(x.replace(/\.[^/.]+$/,""))||$);if(g&&!$.toLowerCase().endsWith(g.toLowerCase())){let T=g.replace(/[\\/:*?"<>|]/g,"");if(T){let D=255-T.length;$.length>D&&($=$.substring(0,D)),$+=T}}let F=[".mp3",".wav",".ogg",".m4a",".m4b",".mp4a",".mpga",".mp2",".mp2a",".m2a",".m3a",".flac",".aac",".wma",".opus",".webm",".weba",".oga",".spx",".mp4",".webm",".ogv",".mov",".avi",".wmv",".flv",".mkv",".m4v",".jpg",".jpeg",".png",".gif",".webp",".svg",".bmp",".ico",".tif",".tiff",".heic",".heif",".avif",".pdf",".txt",".rtf",".srt",".vtt",".ass",".ssa",".sub",".csv",".json",".xml",".yaml",".yml",".toml",".ini",".log",".md",".markdown"],I=d;try{let M=new URL(d,window.location.href);I=M.pathname}catch(B){I=d.split("?")[0].split("#")[0]}let j=I.lastIndexOf("."),H=I.lastIndexOf("/");if(j>H&&-1!==j){let U=I.substring(j).toLowerCase(),O=I.substring(H+1),W=O.match(/\.[a-z0-9]+/gi)||[];if(W.length>1){let N=W.every(e=>F.includes(e.toLowerCase()));if(!N)return}if(!F.includes(U))return}((e,t=!1)=>{let r=document.createElement("a");r.href=e,r.setAttribute("download",$),r.rel="noopener noreferrer",document.body.appendChild(r),r.click(),document.body.removeChild(r),t&&setTimeout(()=>URL.revokeObjectURL(e),100)})(d,!1)}finally{setTimeout(()=>{r=!1},1e3)}}};t.dataset.xmpDownloadBound="1",t.addEventListener("click",a)})}e.setAttribute("data-x-ui","true")}function t(e,t,r,a,i=!0,l=!1){let o,n=!1;if(e instanceof Event){if(n=!0,!e.target.closest(".brxe-xmediaplaylist"))return;o=e.target.closest(".brxe-xmediaplaylist")}else o=e;if(!o||!o.getAttribute("data-x-src"))return;let s=o.getAttribute("data-x-src"),d=o.getAttribute("data-x-title")||"",u=o.getAttribute("data-x-artist")||"",c=t.querySelectorAll(".xmp-download");if(c.length){let p=(e,t)=>{if(!e||!t)return"";let r=e.getAttribute(t);if(!r&&t.startsWith("data-")&&e.dataset){let a=t.substring(5).replace(/-([a-z])/g,(e,t)=>t.toUpperCase());a&&Object.prototype.hasOwnProperty.call(e.dataset,a)&&(r=e.dataset[a]||"")}return r||""},m=(e,r)=>{if(e&&(r?t.setAttribute(e,r):t.removeAttribute(e),e.startsWith("data-"))){let a=e.substring(5).replace(/-([a-z])/g,(e,t)=>t.toUpperCase());a&&(r?t.dataset[a]=r:delete t.dataset[a])}},y=p(o,"data-x-download");m("data-x-download",y);let f=p(o,"data-x-download-filename");m("data-x-download-filename",f),c.forEach(e=>{let t=e?.dataset?.xDownloadSource||"source",r=e?.dataset?.xDownloadUrlAttr||"",a=e?.dataset?.xDownloadFilenameAttr||"";if("data-attribute"===t&&r){let i=p(o,r);m(r,i)}if(a){let l=p(o,a);m(a,l)}})}if(o.hasAttribute("data-x-srcs")){let b=JSON.parse(o.getAttribute("data-x-srcs")||"[]"),$=[];Array.isArray(b)&&b.length>0&&b.forEach(e=>{e.src&&$.push({src:e.src,type:e.type||"video/mp4",width:e.width?parseInt(e.width):void 0,height:e.height?parseInt(e.height):void 0})}),s=$}if(n&&s===t.src)return;if(t.setAttribute("data-x-wait",!0),t.removeAttribute("data-vimeo-primed"),n&&(t.setAttribute("data-x-played-playlist",""),t.querySelectorAll("media-provider track").forEach(e=>{e.remove()}),t.querySelector("iframe")&&(t.querySelector("iframe").style.opacity=0)),a&&a.querySelectorAll(".brxe-xmediaplaylist").forEach(e=>{e.hasAttribute("data-x-item-active")&&(e.removeAttribute("data-x-item-active"),e.dispatchEvent(new Event("x_media_playlist:inactive"))),e.removeAttribute("data-x-item-playing"),e.removeAttribute("data-x-item-paused"),e.querySelector("button")?e.querySelector("button").setAttribute("aria-current","false"):e.setAttribute("aria-current","false")}),o.setAttribute("data-x-item-active",""),o.dispatchEvent(new Event("x_media_playlist:active")),o.querySelector("button")?o.querySelector("button")&&o.querySelector("button").hasAttribute("aria-controls")&&o.querySelector("button").setAttribute("aria-current","true"):o.setAttribute("aria-current","true"),t.textTracks.clear(),o.getAttribute("data-x-texttracks")){let x=o.getAttribute("data-x-texttracks"),g=x?JSON.parse(x):{};Array.isArray(g)&&g.forEach((e,r)=>{let a=document.createElement("track");a.setAttribute("label",e.label),a.setAttribute("src",e.src),a.setAttribute("kind",e.kind),a.setAttribute("srclang",e.language),0===r&&a.setAttribute("default",""),t.querySelector("media-provider").appendChild(a)})}if(o.getAttribute("data-x-chapters")&&setTimeout(()=>{let e=o.getAttribute("data-x-chapters"),r=e?JSON.parse(e):{};t.dispatchEvent(new CustomEvent("x_media_player:switch",{detail:{chapters:r}}))},0),o.getAttribute("data-x-downloads")){let h=o.getAttribute("data-x-downloads");t.setAttribute("data-x-downloads",h)}else t.removeAttribute("data-x-downloads");t.querySelectorAll(".xmp-download").forEach(e=>{"function"==typeof e.updateVisibility&&e.updateVisibility()}),t.clipStartTime=0,t.clipEndTime=0,!t.hasAttribute("controls")&&o.getAttribute("data-x-clip-start")&&(t.clipStartTime=parseInt(o.getAttribute("data-x-clip-start"))),!t.hasAttribute("controls")&&o.getAttribute("data-x-clip-end")&&(t.clipEndTime=parseInt(o.getAttribute("data-x-clip-end")));let v=t.provider?t.provider.type:null,A="unknown";if(Array.isArray(s)){if(s.length>0&&s[0].src){let _=s[0].src;_.includes("youtube.com")||_.includes("youtu.be")?A="youtube":_.includes("vimeo.com")?A="vimeo":_.match(/\.(mp4|webm|ogv)($|\?)/i)?A="video":_.match(/\.(mp3|wav|ogg|flac)($|\?)/i)&&(A="audio")}}else s.includes("youtube.com")||s.includes("youtu.be")?A="youtube":s.includes("vimeo.com")?A="vimeo":s.match(/\.(mp4|webm|ogv)($|\?)/i)?A="video":s.match(/\.(mp3|wav|ogg|flac)($|\?)/i)&&(A="audio");let S=v&&A!==v;if(S){let w=window.fetch;window.fetch=function(e,t){return"about:blank"===e||"object"==typeof e&&"about:blank"===e.url?Promise.resolve(new Response("",{status:200,headers:new Headers({"Content-Type":"text/plain"})})):w.apply(this,arguments)},setTimeout(()=>{window.fetch=w},1e3)}if(n||t.closest(".brxe-xdynamiclightbox")?(t.querySelector(".xmp-time-slider")&&t.querySelector(".xmp-time-slider").style.removeProperty("pointer-events"),t.querySelector(".xmp-poster_initial")&&t.querySelector(".xmp-poster_initial").remove(),t.querySelector("iframe")&&(t.querySelector("iframe").style.opacity=0),t.querySelector("video")&&(t.querySelector("video").style.opacity=0),setTimeout(()=>{o.getAttribute("data-x-poster")?t.poster=o.getAttribute("data-x-poster"):o.getAttribute("data-x-local-poster")?t.poster=o.getAttribute("data-x-local-poster"):t.poster="",setTimeout(()=>{if(S){try{t.pause()}catch(e){}setTimeout(()=>{try{t.src="about:blank"}catch(e){}setTimeout(()=>{try{t.src=s,t.title=d,t.artist=u}catch(e){}},200)},50)}else t.src="",setTimeout(()=>{t.src=s,t.title=d,t.artist=u},50);t.querySelector("iframe")&&t.querySelector("iframe").style.removeProperty("opacity"),t.querySelector("video")&&t.querySelector("video").style.removeProperty("opacity"),"custom"!==r.load&&t.startLoading()},50)},50)):(t.src=s,o.getAttribute("data-x-poster")?t.poster=o.getAttribute("data-x-poster"):r.autoLocalPoster&&(o.hasAttribute("data-x-local-poster")?t.poster=o.getAttribute("data-x-local-poster"):t.querySelector("media-poster")&&t.querySelector("media-poster").subscribe(({src:e})=>{e&&("1"===xMediaPlayer.isLoggedIn||1===xMediaPlayer.isLoggedIn)&&fetch(xMediaPlayer.ajaxurl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({action:"check_poster",video_src:o.getAttribute("data-x-src"),poster_src:e,sec:xMediaPlayer.sec})}).then(e=>e.json()).then(e=>{}).catch(e=>{})})),setTimeout(()=>{t.title=o.getAttribute("data-x-title")||""},0),t.artist="",setTimeout(()=>{t.artist=o.getAttribute("data-x-artist")||""},0)),r.storage&&localStorage&&localStorage.setItem("xmediaplayer_"+t.getAttribute("data-x-id"),o.getAttribute("data-x-src")),setTimeout(()=>{t.querySelector("media-chapters-radio-group")&&(t.querySelector("media-chapters-radio-group").thumbnails="",o.getAttribute("data-x-thumbnails")&&(t.querySelector("media-chapters-radio-group").thumbnails=o.getAttribute("data-x-thumbnails"))),t.querySelector("media-slider-thumbnail")&&(t.querySelector("media-slider-thumbnail").src="",o.getAttribute("data-x-thumbnails")&&(t.querySelector("media-slider-thumbnail").src=o.getAttribute("data-x-thumbnails")))},500),/iPhone/i.test(navigator.userAgent)){let E=o.getAttribute("data-x-src")||"";(E.includes("youtube")||E.includes("vimeo"))&&"play"===t.getAttribute("load")&&t.setAttribute("load","custom")}document.dispatchEvent(new Event("x_media_player:playlist-added")),t.addEventListener("can-play",()=>{let e=t.dataset.xId||"default";setTimeout(()=>{if(void 0!==window.xMediaPlayer.userVolumePreferences[e]&&(t.volume=window.xMediaPlayer.userVolumePreferences[e]),void 0!==window.xMediaPlayer.userMutedPreferences[e]){if(window.xMediaPlayer.userMutedPreferences[e]){t.muted=!0;try{t.remote.mute()}catch(r){}}else{t.muted=!1;try{t.remote.unmute()}catch(a){}}}},100);let r=t.provider;if(0===t.clipStartTime&&!t.hasAttribute("controls")&&r&&"vimeo"===r.type&&/iPhone/i.test(navigator.userAgent)){if(t.muted)t.removeAttribute("data-x-source-loading");else{t.setAttribute("data-vimeo-autoplay-pending","");let a=0,i=0,l=new MutationObserver(e=>{for(let r of e)if("attributes"===r.type&&("data-buffering"===r.attributeName||"data-waiting"===r.attributeName||"data-can-play"===r.attributeName)&&((t.hasAttribute("data-buffering")||t.hasAttribute("data-waiting"))&&a++,t.hasAttribute("data-can-play")&&i++,i>=2&&a>=1&&!t.hasAttribute("data-buffering")&&!t.hasAttribute("data-waiting"))){t.removeAttribute("data-vimeo-autoplay-pending"),t.removeAttribute("data-x-source-loading"),t.paused=!0,t.removeAttribute("data-started");let o=t.querySelector(".xmp-poster");o&&(o.style.opacity="1",o.style.visibility="visible",t.addEventListener("play",function e(){o.style.removeProperty("opacity"),o.style.removeProperty("visibility"),t.removeEventListener("play",e)})),l.disconnect()}},{once:!0});l.observe(t,{attributes:!0}),t.addEventListener("play",()=>{if(t.hasAttribute("data-vimeo-autoplay-pending")){let e=t.hasAttribute("autoplay")||t.hasAttribute("data-autoplay")||"play"===t.getAttribute("load");e||setTimeout(()=>{t.paused=!0,t.removeAttribute("data-started");let e=t.querySelector(".xmp-poster");e&&(e.style.opacity="1",e.style.visibility="visible",t.addEventListener("play",function r(){e.style.removeProperty("opacity"),e.style.removeProperty("visibility"),t.removeEventListener("play",r)}))},0),t.removeAttribute("data-vimeo-autoplay-pending"),t.removeAttribute("data-x-source-loading"),l.disconnect()}},{once:!0}),setTimeout(()=>{t.hasAttribute("data-vimeo-autoplay-pending")&&(t.removeAttribute("data-vimeo-autoplay-pending"),t.removeAttribute("data-x-source-loading"),l.disconnect())},5e3),setTimeout(()=>{let e=t.querySelector("iframe");if(e&&e.src&&e.src.includes("vimeo")){let r=[];if(e.src.includes("autoplay=1")||r.push("autoplay=1"),e.src.includes("gesture=media")||r.push("gesture=media"),r.length>0){let a=e.src.includes("?")?"&":"?";e.src=`${e.src}${a}${r.join("&")}`}}t.setAttribute("data-x-source-loading","")},0)}}else t.removeAttribute("data-x-source-loading")},{once:!0}),t.addEventListener("error",()=>{t.removeAttribute("data-x-source-loading")},{once:!0})}window.addEventListener("unhandledrejection",function(e){e.reason&&"AbortError"===e.reason.name&&"signal is aborted without reason"===e.reason.message&&(e.preventDefault(),e.stopPropagation())}),document.querySelector("body > .brx-body.iframe")||document.addEventListener("visibilitychange",function(){"visible"===document.visibilityState&&document.querySelectorAll('.brxe-xmediaplayer[data-x-view-type="video"]').forEach(e=>{function t(){setTimeout(()=>{e.removeAttribute("data-buffering"),e.removeEventListener("waiting",t)},100)}e.provider?.type==="youtube"&&e.hasAttribute("autoplay")&&!e.hasAttribute("data-x-played")&&e.addEventListener("waiting",t)})}),window.xMediaPlayer||(window.xMediaPlayer={}),window.xMediaPlayer.Instances||(window.xMediaPlayer.Instances={}),window.xMediaPlayer.userVolumePreferences={},window.xMediaPlayer.userMutedPreferences={};let r=function(r,i=!1){"function"==typeof a&&a();let l=r.querySelectorAll(".brxe-xmediaplayer, .brxe-xmediaplayeraudio"),o,n=/iPhone/i.test(navigator.userAgent);l.forEach(a=>{let l=document.querySelector("body > .brx-body.iframe");if(l&&a.hasAttribute("data-x-initialized")||a.closest(".brxe-xdynamiclightbox")&&!a.closest(".brxe-xdynamiclightbox").classList.contains("glightbox-wrapper"))return;let s=a.getAttribute("data-x-media-player"),d=s?JSON.parse(s):{},u=a.getAttribute("data-x-id"),c=a.getAttribute("data-x-view-type");if(a.id||(a.id=u),!d.playlist&&a.hasAttribute("data-x-srcs")){a.getAttribute("src");let p=JSON.parse(a.getAttribute("data-x-srcs")||"[]"),m=[];"video"===c?Array.isArray(p)&&p.length>0&&p.forEach(e=>{e.src&&m.push({src:e.src,type:e.type||"video/mp4",width:e.width?parseInt(e.width):void 0,height:e.height?parseInt(e.height):void 0})}):Array.isArray(p)&&p.length>0&&p.forEach(e=>{e.src&&m.push({src:e.src,type:e.type||"audio/mpeg"})}),a.src=m}"custom"===d.load&&"loaded"===localStorage.getItem("x-media-player")&&a.startLoading();let y=!1,f=(e,t)=>{for(let r of e)if(r.isIntersecting&&(t.unobserve(a),!y)){if(y=!0,"audio"!==a.getAttribute("data-view-type")&&"visible"===d.lazyUI&&!document.querySelector("body > .brx-body.iframe")&&"audio"!==a.getAttribute("data-x-view-type")&&!a.querySelector("media-layout")){let i=null;void 0!==window.xMediaPlayerTemplates&&window.xMediaPlayerTemplates[u]&&(i=window.xMediaPlayerTemplates[u]),i&&(a.insertAdjacentHTML("beforeend",i),a.dispatchEvent(new Event("x_media_player:ui-ready")),a.querySelector("script")&&a.querySelector("script").remove())}"visible"===d.load&&a.startLoading()}},b=new IntersectionObserver(f,{root:null,rootMargin:"0px 0px 200px 0px",threshold:0});if(b.observe(a),"audio"!==a.getAttribute("data-view-type")&&"visible"===d.lazyUI&&!a.querySelector("media-layout")&&!document.querySelector("body > .brx-body.iframe")&&"audio"!==a.getAttribute("data-x-view-type")){let $=a.getBoundingClientRect(),x=$.top<window.innerHeight&&$.bottom>0;x&&!y&&f([{isIntersecting:!0}],b)}document.dispatchEvent(new Event("x_media_player:load-chapters"));let g=a.closest(".brxe-section");a.closest(".brx-popup")?g=a.closest(".brx-popup"):"component"===d.scope&&d.parentComponent?g=a.closest(".brxe-"+d.parentComponent):"selector"===d.scope&&d.scopeSelector?(g=r.querySelector(d.scopeSelector),d.componentScope&&d.parentComponent&&a.closest(".brxe-"+d.parentComponent)&&(g=a.closest(".brxe-"+d.parentComponent).querySelector(d.scopeSelector))):null==d.isLooping||(g=a.closest(".brxe-"+d.isLooping),a.closest(".brxe-"+d.isLooping)||null==d.isLoopingComponent||(g=a.closest(".brxe-"+d.isLoopingComponent))),!i&&a.closest(".ginner-container")&&(g=a.closest(".ginner-container"));let h=!1;function v(e){a.hasAttribute("data-can-fullscreen")?/iPhone/i.test(navigator.userAgent)&&"full_window"===d.fullscreenFallBack?(a.setAttribute("data-x-fullscreen-fallback",""),a.querySelectorAll("media-fullscreen-button").forEach(e=>{e.target="media",e.classList.add("media-fullscreen-button_fallback")})):(a.removeAttribute("data-x-fullscreen-fallback"),a.querySelectorAll("media-fullscreen-button").forEach(e=>{e.classList.remove("media-fullscreen-button_fallback")})):"full_window"===d.fullscreenFallBack||"youtube"===e?(a.setAttribute("data-x-fullscreen-fallback",""),a.querySelectorAll("media-fullscreen-button").forEach(e=>{e.target="media",e.classList.add("media-fullscreen-button_fallback")})):(a.removeAttribute("data-x-fullscreen-fallback"),a.querySelectorAll("media-fullscreen-button").forEach(e=>{e.classList.remove("media-fullscreen-button_fallback")}))}n&&(a.querySelector(".xmp-youtube")||a.querySelector(".xmp-vimeo"))&&"play"===a.getAttribute("load")&&a.setAttribute("load","custom");let A=a.dataset.xId||"default";if(a.addEventListener("media-volume-change-request",e=>{if(window.xMediaPlayer.userVolumePreferences[A]=e.detail,a.dataset.xId)try{localStorage.setItem("xmediaplayer_volume_"+a.dataset.xId,window.xMediaPlayer.userVolumePreferences[A])}catch(t){console.warn("Could not store volume in localStorage",t)}}),a.addEventListener("media-mute-request",()=>{if(window.xMediaPlayer.userMutedPreferences[A]=!0,a.dataset.xId)try{localStorage.setItem("xmediaplayer_muted_"+a.dataset.xId,"1")}catch(e){console.warn("Could not store muted state in localStorage",e)}}),a.addEventListener("media-unmute-request",()=>{if(window.xMediaPlayer.userMutedPreferences[A]=!1,a.dataset.xId)try{localStorage.setItem("xmediaplayer_muted_"+a.dataset.xId,"0")}catch(e){console.warn("Could not store muted state in localStorage",e)}}),a.addEventListener("provider-setup",e=>{let t=e.detail;if(t?.type==="video"&&(h=e.detail.media)&&"VIDEO"===h.tagName&&h.setAttribute("disableRemotePlayback",""),t?.type==="audio"&&(h=t.audio)&&h.setAttribute("disableRemotePlayback",""),"none"!==d.fullscreenFallBack&&v(t?.type),a.dataset.xId)try{let r=localStorage.getItem("xmediaplayer_volume_"+a.dataset.xId),i=localStorage.getItem("xmediaplayer_muted_"+a.dataset.xId);null!==r&&(window.xMediaPlayer.userVolumePreferences[A]=parseFloat(r)),null!==i&&(window.xMediaPlayer.userMutedPreferences[A]="1"===i)}catch(l){console.warn("Could not restore volume settings from localStorage",l)}}),a.addEventListener("can-load-poster",()=>{setTimeout(()=>{a.querySelector(".xmp-poster_initial")&&a.querySelector("media-poster img").style.removeProperty("opacity")},300)}),!i){a.querySelector(".xmp-controls")&&a.querySelector(".xmp-controls").style.removeProperty("visibility"),a.querySelector('[action="toggle:controls"]')&&a.querySelector("media-controls")&&a.querySelector('[action="toggle:controls"]').addEventListener("trigger",e=>{a.querySelector("media-controls").hasAttribute("data-visible")&&e.preventDefault()});let _=!1;a.subscribe(({seeking:e})=>{a.provider?.type==="vimeo"&&(e?a.paused||(_=!0,a.paused=!0):_&&setTimeout(()=>{a.paused=!1,_=!1},50))});let S=!!a.hasAttribute("data-bandwidth-estimate")&&parseFloat(a.getAttribute("data-bandwidth-estimate")),w=a.hasAttribute("data-first-level")?parseInt(a.getAttribute("data-first-level")):-1,E=a.hasAttribute("data-start-level")?parseInt(a.getAttribute("data-start-level")):-1;if(a.addEventListener("provider-change",e=>{var t;let r=e.detail;if(r){if(t=a,document.querySelector("body > .brx-body.iframe"),t._bufferingMonitorActive||(t._bufferingMonitorActive=!0,t.addEventListener("buffering-change",e=>{let r=e.detail;t._bufferingTimeoutId&&(clearTimeout(t._bufferingTimeoutId),t._bufferingTimeoutId=null),r?t._bufferingTimeoutId=setTimeout(()=>{t.hasAttribute("data-buffering")&&(t.readyState>=2||t.currentTime>0)&&t.removeAttribute("data-buffering"),t._bufferingTimeoutId=null},3e3):t.hasAttribute("data-buffering")&&t.removeAttribute("data-buffering")}),t.addEventListener("can-play",()=>{t.hasAttribute("data-buffering")&&t.removeAttribute("data-buffering")}),t.addEventListener("playing",()=>{t.hasAttribute("data-buffering")&&t.removeAttribute("data-buffering")})),a.hasAttribute("controls")&&(a.clipStartTime=0,a.clipEndTime=0),r?.type==="hls"){r.library=xMediaPlayer.pluginDir+"js/hls.js";let i={downlink:null,effectiveType:null,type:null};if(navigator.connection){let l=navigator.connection;i.downlink=20*l.downlink,i.effectiveType=l.effectiveType,i.type=l.type}let o={};S?o.abrEwmaDefaultEstimate=1e6*S:i.downlink?o.abrEwmaDefaultEstimate=1e6*i.downlink:i.effectiveType&&i.type&&("4g"===i.effectiveType||"wifi"===i.type?(o.firstLevel=w,o.startLevel=E):o.abrEwmaDefaultEstimate=5e6),r.config=o}else(r?.type==="youtube"||r?.type==="vimeo")&&(a.querySelector(".xmp-audio-menu")&&a.querySelector('media-audio-gain-slider[aria-disabled="true"]')&&(a.querySelector(".xmp-audio-menu .xmp-menu-item").disabled=!0),r?.type==="vimeo"&&n&&a.setAttribute("data-x-hide-fullscreen",""),(r?.type==="youtube"||r?.type==="vimeo")&&n&&("play"===a.getAttribute("load")&&a.setAttribute("load","custom"),("play"===a.getAttribute("load")||"click"===a.getAttribute("load"))&&a.setAttribute("data-x-no-click-to-play","")),"none"!==d.fullscreenFallBack&&v(r?.type))}}),a.hasAttribute("data-title")&&(a.title=a.getAttribute("data-title"),l&&a.subscribe(({title:e})=>{e&&function e(t){if(!t)return;let r;if(Array.isArray(t))r=t.join(" ");else{let i=String(t);r=i.replace(/,,/g,"##COMMA##").replace(/,(?!\s)/g," ").replace(/##COMMA##/g,", ")}a.title=r}(e)})),a.addEventListener("x_media_player:ui-ready",()=>{e(a,d,g)}),!l&&d.detectLanguage){let k=document.documentElement.lang,q=!1,L=null,C=!1;a.addEventListener("loaded-metadata",()=>{for(let e of a.textTracks){let t=e.language?e.language.replace(/-auto$/,""):"";t&&k.startsWith(t)&&!q&&(L=e,q=!0),e.mode="disabled"}a.textTracks.addEventListener("add",e=>{let t=e.detail,r=t.language?t.language.replace(/-auto$/,""):"";r&&k.startsWith(r)&&!q&&(L=t,q=!0,setTimeout(()=>{let e=a.querySelector("media-captions-radio-group");if(e){let t=Array.from(e.querySelectorAll('media-radio[value^="vds-"]')),i=t.find(e=>{let t=e.getAttribute("value");if(t&&r){let a=t.match(/\/([a-z]{2})(-auto)?\.vtt/);if(a&&a[1]===r)return!0}return!1});if(i){let l=e.querySelector('media-radio[value="off"]');l&&l.nextSibling&&e.insertBefore(i,l.nextSibling)}}},100)),t.mode="disabled"})}),a.addEventListener("media-text-track-change-request",e=>{let{detail:t}=e;t&&"showing"===t.mode&&L&&!C&&(setTimeout(()=>{for(let e of a.textTracks)e.mode=e===L?"showing":"disabled"},0),C=!0)})}a.addEventListener("can-play",()=>{d.autoCaptionsBunny&&a.provider?.type==="hls"&&a.src&&a.src.includes("b-cdn.net")&&!document.querySelector("body > .brx-body.iframe")&&function e(t){if(l)return;let r=t.src;if(r)try{let a=new URL(r),i=a.pathname,o=r.match(/([a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12})/i),n=null;if(o&&o[1])n=o[1];else{let s=i.split("/").filter(e=>e);s.length>1&&(n=s[s.length-2])}if(!n)return;let d=a.hostname,u="";if(d.includes(".b-cdn.net")){let c=d.split(".")[0].replace("vz-","");c&&(u=c)}fetch(`/wp-json/bricksextras/v1/bunny-captions/${u}/${n}`,{headers:{"X-WP-Nonce":window?.xMediaPlayer?.captions||""}}).then(e=>{if(!e.ok)throw Error("Network response was not ok");return e.json()}).then(e=>{e.captions&&Object.keys(e.captions).length>0&&function e(t,r){if(!t)return;let a=t.querySelector("media-provider");a&&Object.keys(r).forEach(e=>{let t=r[e],i=document.createElement("track");i.kind="subtitles",i.src=t.url,i.srclang=t.language,i.label=t.label||t.language,i.default=!1,a.appendChild(i)})}(t,e.captions)}).catch(e=>{console.error("Error loading Bunny Stream captions:",e)})}catch(p){console.error("Error loading Bunny Stream captions:",p)}}(a),document.querySelector("body > .brx-body.iframe")?setTimeout(()=>{a.removeAttribute("data-buffering")},300):setTimeout(()=>{if(0===a.clipStartTime&&a.provider?.type==="vimeo"&&/iPhone/i.test(navigator.userAgent)){let e=a.querySelector("iframe");if(e&&!a.hasAttribute("data-vimeo-primed")){a.setAttribute("data-vimeo-primed","true");try{e.contentWindow.postMessage(JSON.stringify({method:"setCurrentTime",value:1}),"*"),setTimeout(()=>{e.contentWindow.postMessage(JSON.stringify({method:"setCurrentTime",value:0}),"*")},50)}catch(t){console.error("Error priming Vimeo player:",t)}}}},50),a.getAttribute("data-artist")&&(a.artist=a.getAttribute("data-artist")),a.getAttribute("data-x-ui")||e(a,d,g),window.xMediaPlayer&&window.xMediaPlayer.Instances&&(window.xMediaPlayer.Instances[a.dataset.xId]=a),a.dispatchEvent(new Event("x_media_player:ready")),a.setAttribute("data-x-loaded",""),d.thumbnails&&setTimeout(()=>{a.querySelector("media-slider-thumbnail")&&(a.querySelector("media-slider-thumbnail").src=d.thumbnails),a.querySelector("media-chapters-radio-group")&&(a.querySelector("media-chapters-radio-group").thumbnails=d.thumbnails)},1e3),a.addEventListener("started",()=>{a.hasAttribute("data-x-play-reset")||a.setAttribute("data-x-played","true"),a.removeAttribute("data-x-hide-fullscreen",""),setTimeout(()=>{a.removeAttribute("data-x-wait")},200)}),setTimeout(()=>{a.querySelector("iframe")&&a.querySelector("iframe").style.removeProperty("opacity")},0);let t=!1;if(a.querySelector(".xmp-settings-button")){if(t)return;t=!0,a.querySelectorAll(".xmp-settings-menu").forEach(e=>{let t=e.contentElement;t&&(t.querySelector(".xmp-speed-menu-section .xmp-menu-section-value")&&t.querySelector("media-speed-slider")&&(t.querySelector("media-speed-slider").hidden||a.subscribe(({playbackRate:e})=>{t.querySelectorAll(".xmp-speed-menu-section .xmp-menu-section-value").forEach(t=>{t.innerText=e})})),t.querySelector(".xmp-quality-menu-section .xmp-menu-section-value")&&a.subscribe(({quality:e})=>{null!=e?t.querySelectorAll(".xmp-quality-menu-section .xmp-menu-section-value").forEach(t=>{t.innerText=e.height+"p"}):t.querySelectorAll(".xmp-quality-menu-section .xmp-menu-section-value").forEach(e=>{e.innerText="Auto"}),setTimeout(()=>{t.querySelector(".xmp-quality-menu-section")&&t.querySelector('.xmp-quality-menu-section media-quality-slider[aria-disabled="true"]')?t.querySelectorAll(".xmp-quality-menu-section").forEach(e=>{e.style.display="none"}):t.querySelectorAll(".xmp-quality-menu-section").forEach(e=>{e.style.display="block"})},100)}))})}});let P=a.querySelector("media-poster");P&&!d.playlist&&d.autoLocalPoster&&(a.hasAttribute("data-x-local-poster")?P.src=a.getAttribute("data-x-local-poster"):($hasfetched=!1,P.subscribe(({src:e})=>{!$hasfetched&&e&&("1"===xMediaPlayer.isLoggedIn||1===xMediaPlayer.isLoggedIn)&&fetch(xMediaPlayer.ajaxurl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({action:"check_poster",video_src:a.src,poster_src:e,sec:xMediaPlayer.sec})}).then(e=>e.json()).then(e=>{document.querySelector("body > .brx-body.iframe")&&($hasfetched=!0)}).catch(e=>{})}))),d.autoPause&&function e(t){t.subscribe(({paused:e})=>{e||document.querySelectorAll("media-player").forEach((e,r)=>{if(e!==t&&"function"==typeof e.pause&&!e.paused)try{e.pause()}catch(a){}})})}(a),d.pauseOutOfView&&a.addEventListener("playing",()=>{!function e(t){let r=(e,r)=>{for(let a of e)a.isIntersecting||(t.pause(),r.unobserve(t))},a=new IntersectionObserver(r,{root:null,rootMargin:"0px 0px 200px 0px",threshold:0});a.observe(t)}(a)}),d.startURLParamKey&&function e(t,r=!1){if(!r)return;let a=new URLSearchParams(window.location.search);if(a.has(r)){let i=parseInt(a.get(r));!isNaN(i)&&i>=0&&(t.currentTime=i)}}(a,d.startURLParamKey);let T=0,D=new xMediaTimer(function(){T=++T,a.dispatchEvent(new CustomEvent("x_media_player:watching",{detail:{count:T}}))},1e3);l||a.addEventListener("can-play",()=>{if(a.addEventListener("playing",D.resume),a.addEventListener("pause",D.pause),a.addEventListener("seeking",D.pause),l&&!a.qualities.readonly&&a.qualities.length){let e=a.qualities[a.qualities.length-1];e.selected=!0}}),a.closest(".brxe-xtabs")&&(a.closest(".brxe-xtabs").addEventListener("x_tabs:switch",()=>{a.paused=!0}),a.closest(".brxe-xtabs").addEventListener("x_tabs_accordion:collapse",()=>{a.paused=!0}),a.closest(".brxe-xtabs").addEventListener("x_tabs_accordion:expand",()=>{a.paused=!0})),a.closest(".x-accordion")&&(a.closest(".x-accordion").addEventListener("x_accordion:collapse",()=>{a.paused=!0}),a.closest(".x-accordion").addEventListener("x_accordion:expand",()=>{a.paused=!0}))}if(!i&&(function e(t,r){let a=(e,r)=>{for(let a of e)a.isIntersecting&&t.querySelector("media-poster img")&&""==t.querySelector("media-poster img").src&&(t.startLoadingPoster(),r.unobserve(t))},i=new IntersectionObserver(a,{root:null,rootMargin:"0px 0px 200px 0px",threshold:0});i.observe(t)}(a,d),a.subscribe(({poster:e})=>{e&&a.querySelector('[data-x-control-type="poster-image"] [data-x-poster]')&&a.querySelectorAll('[data-x-control-type="poster-image"] [data-x-poster]').forEach(t=>{t.setAttribute("srcset",e),t.src=e})}),d.poster&&(a.poster=d.poster,a.querySelector("img[data-x-poster]")&&a.querySelectorAll("img[data-x-poster]").forEach(e=>{e.src=d.poster}))),d.playlist&&g){if((o=g.querySelectorAll(".brxe-xmediaplaylist")).length&&o.forEach((e,t)=>{let r=e.querySelector("button")||e;r.addEventListener("keydown",t=>{if("ArrowDown"===t.key||"ArrowUp"===t.key||"Home"===t.key||"End"===t.key){t.preventDefault();let r=g.querySelectorAll(".brxe-xmediaplaylist");if(!r.length)return;let a=Array.from(r).indexOf(e);if(-1===a)return;let i;"ArrowDown"===t.key?i=a<r.length-1?a+1:0:"ArrowUp"===t.key?i=a>0?a-1:r.length-1:"Home"===t.key?i=0:"End"===t.key&&(i=r.length-1);let l=r[i],o=l.querySelector("button")||l;o.focus()}})}),!i){let F=o[0];if(d.storage&&localStorage&&localStorage.getItem("xmediaplayer_"+a.getAttribute("data-x-id"))){let I=localStorage.getItem("xmediaplayer_"+a.getAttribute("data-x-id"));F=g.querySelector('.brxe-xmediaplaylist[data-x-src="'+I+'"]')}F&&F.hasAttribute("data-x-src")&&((F.getAttribute("data-x-src").includes("youtu")||F.getAttribute("data-x-src").includes("vimeo"))&&/iPhone/i.test(navigator.userAgent)&&("play"===a.getAttribute("load")&&a.setAttribute("load","custom"),("play"===a.getAttribute("load")||"click"===a.getAttribute("load"))&&a.setAttribute("data-x-no-click-to-play","")),function e(r,a,i,l=!1){return t(r,a,i,null,!0,l)}(F,a,d,!1))}document.querySelector("body > .brx-body.iframe")||(g.addEventListener("click",e=>{let r=e.target.closest(".brxe-xmediaplaylist");r&&r.getAttribute("data-x-src")&&"function"==typeof M&&(a.removeEventListener("can-play",M),a.querySelectorAll("media-play-button").forEach(e=>{e.removeEventListener("media-play-request",M)})),t(e,a,d,g,!1,!0)}),g.addEventListener("keypress",e=>{t(e,a,d,g,!1,!0)})),o.forEach(e=>{e.querySelector("button")?a.hasAttribute("id")&&e.querySelector("button").setAttribute("aria-controls",a.id):a.hasAttribute("id")&&e.setAttribute("aria-controls",a.id)}),d.playListNext&&a.addEventListener("ended",()=>{let e=[],t=g.querySelectorAll(".brxe-xmediaplaylist");t.forEach((r,a)=>{r.hasAttribute("data-x-item-active")&&(a<t.length-1&&e.push(t[a+1]),d.playListLoop&&a===t.length-1&&e.push(t[0]))}),0!==e.length&&setTimeout(()=>{e[0].click()},d.playListDelay)}),a.subscribe(({paused:e})=>{g.querySelectorAll(".brxe-xmediaplaylist").forEach(t=>{t.hasAttribute("data-x-item-active")&&(e?(t.dispatchEvent(new Event("x_media_playlist:paused")),t.setAttribute("data-x-item-paused",""),t.removeAttribute("data-x-item-playing")):(t.dispatchEvent(new Event("x_media_playlist:playing")),t.setAttribute("data-x-item-playing",""),t.removeAttribute("data-x-item-paused"),t.removeAttribute("data-x-item-ended")))})}),a.subscribe(({ended:e})=>{e&&o.forEach(e=>{e.hasAttribute("data-x-item-active")&&(e.dispatchEvent(new Event("x_media_playlist:ended")),e.setAttribute("data-x-item-ended",""),e.removeAttribute("data-x-item-playing"),e.removeAttribute("data-x-item-paused"))})}),a.subscribe(({artist:e})=>{if(a.querySelector(".xmp-artist_name")){a.querySelector(".xmp-artist_name").textContent=e||"";let t=a.querySelector(".xmp-artist");e?t.setAttribute("data-x-has-artist",""):t.removeAttribute("data-x-has-artist")}})}function M(){a.hasAttribute("data-iphone")&&a.provider?.type==="youtube"||(a.paused=!1,a.removeEventListener("can-play",M))}if(("play"===d.load||"click"===d.load)&&(function e(t){function r(e){(void 0===e.code||"Enter"===e.code||"Space"===e.code)&&t.startLoading(),t.addEventListener("can-play",()=>{t.removeEventListener("click",r),t.removeEventListener("keydown",r),t.removeEventListener("pointerup",r),t.querySelectorAll("media-play-button").forEach(e=>{e.removeEventListener("keydown",r)})})}t.querySelectorAll(".xmp-button:not(.media-layout_init .xmp-button)").forEach(e=>{e.style.removeProperty("pointer-events")}),t.addEventListener("click",r),t.addEventListener("pointerup",r),t.addEventListener("keydown",r),t.querySelectorAll("media-play-button").forEach(e=>{e.addEventListener("keydown",r)})}(a),d.clickToPlay&&(a.addEventListener("keyup",function e(t){"Enter"===t.code&&t.target&&t.target.classList.contains("brxe-xmediaplayer")&&(a.paused?a.paused=!1:a.paused=!0)}),a.querySelectorAll("media-play-button").forEach(e=>{e.addEventListener("media-play-request",M),a.hasAttribute("data-can-play")||a.addEventListener("can-play",M)}))),l&&(a.setAttribute("data-x-initialized",""),"audio"===c)){a.getAttribute("data-x-id");let B=!1,j=()=>{if(B)return;let e=a.querySelector("audio"),t=a.querySelector(".xmp-time-slider_waveform");e&&e.src&&t&&(B=!0,setTimeout(()=>{let e=new Event("load-start");a.dispatchEvent(e)},100))};j();let H=new MutationObserver(e=>{for(let t of e)"childList"===t.type&&t.addedNodes.length?j():"attributes"===t.type&&"src"===t.attributeName&&"AUDIO"===t.target.tagName&&j()});H.observe(a,{childList:!0,attributes:!0,attributeFilter:["src"],subtree:!0})}a.addEventListener("can-play",()=>{a.removeAttribute("data-x-source-loading")});let U=!1;if(a.addEventListener("started",()=>{U=!0}),a.addEventListener("play",()=>{U&&a.dispatchEvent(new Event("x_media_player:resume"))}),"audio"===c){function O(e=!1){let t=(e,t)=>{let r;return(...a)=>{r&&clearTimeout(r),r=setTimeout(()=>e(...a),t)}},r=a.querySelector(".xmp-time-slider_waveform");if(!r)return;let i=a.src;if(Array.isArray(i)&&i.length>0&&(i=i[0]),!i||("string"==typeof i?i=i.split("#")[0].split("?")[0].trim():i&&(i=String(i).trim()),!i))return;let o=r.getContext("2d");window.beSharedAudioContext=window.beSharedAudioContext||new(window.AudioContext||window.webkitAudioContext);let n=window.beSharedAudioContext,s="true"===r.dataset.enableWaveform,d=r.dataset.barWidth?parseInt(r.dataset.barWidth,10):2,u=r.dataset.barGap?parseInt(r.dataset.barGap,10):1;function c(e,t){if(!e)return t;try{let r=JSON.parse(e);if(r.raw&&r.raw.startsWith("var")){let a=r.raw.replace(/^var\(([^)]+)\)$/,"$1");return getComputedStyle(document.documentElement).getPropertyValue(a).trim()||t}if(r.hex)return r.hex;if("string"==typeof r)return r;return t}catch(i){return e||t}}let p=c(r.dataset.playedColor,"#fff"),m=c(r.dataset.waveformColor,"#616063"),y=d+u;if(!1===s)return;let f=window.devicePixelRatio||1,b=r.dataset.height?parseInt(r.dataset.height,10):30;r.width=r.offsetWidth*f,r.height=b*f,o.scale(f,f);let $=r.offsetWidth,x=b;(async()=>{try{let e="string"==typeof i?i.split("#")[0]:String(i),s=[],u=null,c,b=0,g=!1,h="be_waveform_"+function e(t){function r(e,t){return e<<t|e>>>32-t}function a(e,t){var r,a,i,l,o;return(i=2147483648&e,l=2147483648&t,r=1073741824&e,a=1073741824&t,o=(1073741823&e)+(1073741823&t),r&a)?2147483648^o^i^l:r|a?1073741824&o?3221225472^o^i^l:1073741824^o^i^l:o^i^l}function i(e,t,r){return e&t|~e&r}function l(e,t,r){return e&r|t&~r}function o(e,t,r){return e^t^r}function n(e,t,r){return t^(e|~r)}function s(e,t,i,l,o,n,s){var d,u,c;return e=a(e,a(a((d=t,u=i,c=l,d&u|~d&c),o),s)),a(r(e,n),t)}function d(e,t,i,l,o,n,s){var d,u,c;return e=a(e,a(a((d=t,u=i,c=l,d&c|u&~c),o),s)),a(r(e,n),t)}function u(e,t,i,l,o,n,s){var d,u,c;return e=a(e,a(a((d=t,u=i,c=l,d^u^c),o),s)),a(r(e,n),t)}function c(e,t,i,l,o,n,s){var d,u,c;return e=a(e,a(a((d=t,u=i,c=l,u^(d|~c)),o),s)),a(r(e,n),t)}function p(e){var t,r,a="",i="";for(r=0;r<=3;r++)a+=(i="0"+(t=e>>>8*r&255).toString(16)).substr(i.length-2,2);return a}var m,y,f,b,$,x,g,h,v,A=[];for(m=0,A=function e(t){for(var r,a=t.length,i=a+8,l=((i-i%64)/64+1)*16,o=Array(l-1),n=0,s=0;s<a;)r=(s-s%4)/4,n=s%4*8,o[r]=o[r]|t.charCodeAt(s)<<n,s++;return r=(s-s%4)/4,n=s%4*8,o[r]=o[r]|128<<n,o[l-2]=a<<3,o[l-1]=a>>>29,o}(t=function e(t){t=t.replace(/\r\n/g,"\n");for(var r="",a=0;a<t.length;a++){var i=t.charCodeAt(a);i<128?r+=String.fromCharCode(i):i>127&&i<2048?(r+=String.fromCharCode(i>>6|192),r+=String.fromCharCode(63&i|128)):(r+=String.fromCharCode(i>>12|224),r+=String.fromCharCode(i>>6&63|128),r+=String.fromCharCode(63&i|128))}return r}(t)),x=1732584193,g=4023233417,h=2562383102,v=271733878;m<A.length;m+=16)y=x,f=g,b=h,$=v,x=s(x,g,h,v,A[m+0],7,3614090360),v=s(v,x,g,h,A[m+1],12,3905402710),h=s(h,v,x,g,A[m+2],17,606105819),g=s(g,h,v,x,A[m+3],22,3250441966),x=s(x,g,h,v,A[m+4],7,4118548399),v=s(v,x,g,h,A[m+5],12,1200080426),h=s(h,v,x,g,A[m+6],17,2821735955),g=s(g,h,v,x,A[m+7],22,4249261313),x=s(x,g,h,v,A[m+8],7,1770035416),v=s(v,x,g,h,A[m+9],12,2336552879),h=s(h,v,x,g,A[m+10],17,4294925233),g=s(g,h,v,x,A[m+11],22,2304563134),x=s(x,g,h,v,A[m+12],7,1804603682),v=s(v,x,g,h,A[m+13],12,4254626195),h=s(h,v,x,g,A[m+14],17,2792965006),g=s(g,h,v,x,A[m+15],22,1236535329),x=d(x,g,h,v,A[m+1],5,4129170786),v=d(v,x,g,h,A[m+6],9,3225465664),h=d(h,v,x,g,A[m+11],14,643717713),g=d(g,h,v,x,A[m+0],20,3921069994),x=d(x,g,h,v,A[m+5],5,3593408605),v=d(v,x,g,h,A[m+10],9,38016083),h=d(h,v,x,g,A[m+15],14,3634488961),g=d(g,h,v,x,A[m+4],20,3889429448),x=d(x,g,h,v,A[m+9],5,568446438),v=d(v,x,g,h,A[m+14],9,3275163606),h=d(h,v,x,g,A[m+3],14,4107603335),g=d(g,h,v,x,A[m+8],20,1163531501),x=d(x,g,h,v,A[m+13],5,2850285829),v=d(v,x,g,h,A[m+2],9,4243563512),h=d(h,v,x,g,A[m+7],14,1735328473),g=d(g,h,v,x,A[m+12],20,2368359562),x=u(x,g,h,v,A[m+5],4,4294588738),v=u(v,x,g,h,A[m+8],11,2272392833),h=u(h,v,x,g,A[m+11],16,1839030562),g=u(g,h,v,x,A[m+14],23,4259657740),x=u(x,g,h,v,A[m+1],4,2763975236),v=u(v,x,g,h,A[m+4],11,1272893353),h=u(h,v,x,g,A[m+7],16,4139469664),g=u(g,h,v,x,A[m+10],23,3200236656),x=u(x,g,h,v,A[m+13],4,681279174),v=u(v,x,g,h,A[m+0],11,3936430074),h=u(h,v,x,g,A[m+3],16,3572445317),g=u(g,h,v,x,A[m+6],23,76029189),x=u(x,g,h,v,A[m+9],4,3654602809),v=u(v,x,g,h,A[m+12],11,3873151461),h=u(h,v,x,g,A[m+15],16,530742520),g=u(g,h,v,x,A[m+2],23,3299628645),x=c(x,g,h,v,A[m+0],6,4096336452),v=c(v,x,g,h,A[m+7],10,1126891415),h=c(h,v,x,g,A[m+14],15,2878612391),g=c(g,h,v,x,A[m+5],21,4237533241),x=c(x,g,h,v,A[m+12],6,1700485571),v=c(v,x,g,h,A[m+3],10,2399980690),h=c(h,v,x,g,A[m+10],15,4293915773),g=c(g,h,v,x,A[m+1],21,2240044497),x=c(x,g,h,v,A[m+8],6,1873313359),v=c(v,x,g,h,A[m+15],10,4264355552),h=c(h,v,x,g,A[m+6],15,2734768916),g=c(g,h,v,x,A[m+13],21,1309151649),x=c(x,g,h,v,A[m+4],6,4149444226),v=c(v,x,g,h,A[m+11],10,3174756917),h=c(h,v,x,g,A[m+2],15,718787259),g=c(g,h,v,x,A[m+9],21,3951481745),x=a(x,y),g=a(g,f),h=a(h,b),v=a(v,$);return(p(x)+p(g)+p(h)+p(v)).toLowerCase()}(e);function v(e){if(!e||0===e.length)return[];let t=[e[0]];for(let r=1;r<e.length;r++)t.push(e[r]-e[r-1]);return t}function A(e){if(!e||0===e.length)return[];let t=[e[0]];for(let r=1;r<e.length;r++)t.push(t[r-1]+e[r]);return t}function _(e,t,r,a){let i=[],l=e.scale,o,n;e._decodedMin&&e._decodedMax?(o=e._decodedMin,n=e._decodedMax):(o=A(e.min),n=A(e.max),e._decodedMin=o,e._decodedMax=n);for(let s=0;s<o.length;s++)i.push([o[s]/l,n[s]/l]);let d=parseFloat(e.full_duration)||0,u=d||1,c=Math.floor(t/u*i.length),p=Math.ceil(r/u*i.length);c=Math.max(0,Math.min(c,i.length-1)),p=Math.max(c+1,Math.min(p,i.length));let m=i.slice(c,p);if(0===m.length&&(m=i),m.length<100){let y=[],f=Math.ceil(100/m.length);for(let b=0;b<m.length;b++)for(let $=0;$<f;$++)y.push(m[b]);m=y}return{peaks:m,clipStart:t,clippedDuration:a}}function S(e){if(!e||"object"!=typeof e||(e.waveform_data&&"object"==typeof e.waveform_data&&(e=e.waveform_data),!("scale"in e)||"number"!=typeof e.scale||!Array.isArray(e.min)||!Array.isArray(e.max)||0===e.min.length||e.min.length!==e.max.length))return!1;let t=e.min.some(e=>"number"!=typeof e),r=e.max.some(e=>"number"!=typeof e);return!t&&!r}try{let w=localStorage.getItem(h);if(w){let E=JSON.parse(w);if(S(E)){let k=parseFloat(a.getAttribute("clip-start-time"))||0,q=parseFloat(a.getAttribute("clip-end-time"))||(u?u.full_duration:0);u=E;let L=_(E,k,q,q-k);s=L.peaks,clipStart=L.clipStart,b=L.clippedDuration,g=!0}else localStorage.removeItem(h)}}catch(C){console.log("Error accessing localStorage:",C)}if(!g){try{let P=xMediaPlayer.ajaxurl+"?action=get_waveform_data&audio_url="+encodeURIComponent(e)+"&security="+encodeURIComponent(xMediaPlayer.sec),T=await fetch(P,{method:"GET",credentials:"same-origin",mode:"cors",headers:{Accept:"application/json"}});if(!T.ok)throw Error(`Server responded with status: ${T.status}`);let D=await T.json();if(D.success&&D.data){if(S(D.data)){let F=parseFloat(a.getAttribute("clip-start-time"))||0,I=parseFloat(a.getAttribute("clip-end-time"))||D.data.full_duration||0,M;u=M=D.data.waveform_data?{...D.data.waveform_data,full_duration:D.data.full_duration}:D.data;let B=_(M,F,I,I-F);s=B.peaks,clipStart=B.clipStart,b=B.clippedDuration,g=!0,eT();try{localStorage.setItem(h,JSON.stringify(M));let j=localStorage.getItem(h);j&&JSON.parse(j)}catch(H){console.log("Error saving to localStorage:",H)}}else console.warn("Invalid waveform data structure in server response")}}catch(U){console.log("Error fetching waveform data from server:",U)}if(!g)try{let O=await fetch(i);if(!O.ok){console.info(`BricksExtras: Waveform generation skipped: Audio file could not be loaded (${O.status} ${O.statusText})`);return}let W=await O.arrayBuffer(),N=await n.decodeAudioData(W),R=N.getChannelData(0);c=R,clipStart=0,b=N.duration,s=[];let V=[],z=[],G=[];for(let K=0;K<2e3;K++){let X=K/2e3,Y=Math.floor(X*c.length),J=Math.floor((K+1)/2e3*c.length),Q=Math.floor((J-Y)*1/2),Z=Math.max(0,Y-Q),ee=Math.min(c.length-1,J+Q),et=1,er=-1,ea=0,ei=0;for(let el=Y;el<J;el++){let eo=c[el];eo<et&&(et=eo),eo>er&&(er=eo)}for(let en=Z;en<ee;en++){let es=c[en];ea+=es*es,ei++}let ed=Math.sqrt(ea/(ei||1));V.push([et,er]);let eu=-(5*ed),ec=5*ed;{let ep=Math.abs(eu),em=Math.abs(ec),ey=Math.pow(ep,.5),ef=Math.pow(em,.5);eu=eu<0?-ey:ey,ec=ec<0?-ef:ef}eu=Math.max(eu,-1),ec=Math.min(ec,1),z.push([eu,ec]);let eb=.85*eu+.15000000000000002*et,e$=.85*ec+.15000000000000002*er;G.push([eb,e$]),s.push([Math.round(1e3*eb),Math.round(1e3*e$)])}let ex=s.map(e=>e[0]),eg=s.map(e=>e[1]),eh=v(ex),ev=v(eg),eA={scale:1e3,min:eh,max:ev,full_duration:N.duration};u={scale:eA.scale,min:[...eh],max:[...ev],full_duration:eA.full_duration},s=[];let e_=A(eA.min),eS=A(eA.max);for(let ew=0;ew<e_.length;ew++)s.push([e_[ew],eS[ew]]);try{let eE=JSON.stringify(eA);(new Blob([eE]).size/1024).toFixed(2),localStorage.setItem(h,eE)}catch(ek){console.log("Error saving to localStorage:",ek)}if("1"===xMediaPlayer.isLoggedIn||1===xMediaPlayer.isLoggedIn)try{let eq=new FormData;eq.append("action","save_waveform_data"),eq.append("audio_url",e),eq.append("security",xMediaPlayer.sec),eq.append("full_duration",N.duration),eq.append("data_resolution",1);let eL={scale:eA.scale,min:eA.min,max:eA.max};eq.append("waveform_data",JSON.stringify(eL));let e8=await fetch(xMediaPlayer.ajaxurl,{method:"POST",body:eq}),e0=await e8.json();e0.success}catch(eC){}}catch(eP){console.info("BricksExtras: Waveform generation skipped:",eP.message||"Could not process audio file")}}function e2(e,t,r,a,i,l){let o=Math.min(l,a/2,i/2);e.beginPath(),e.moveTo(t+o,r),e.lineTo(t+a-o,r),e.quadraticCurveTo(t+a,r,t+a,r+o),e.lineTo(t+a,r+i-o),e.quadraticCurveTo(t+a,r+i,t+a-o,r+i),e.lineTo(t+o,r+i),e.quadraticCurveTo(t,r+i,t,r+i-o),e.lineTo(t,r+o),e.quadraticCurveTo(t,r,t+o,r),e.closePath(),e.fill()}function eT(){if(void 0===e)var e=0,t=0;let r=performance.now();if(t++,r-e>1e3&&(t=0,e=r),$<=0||x<=0||!s||0===s.length)return!1;let i=a.currentTime||0;if(isNaN(b)||b<=0){let l=u?u.full_duration:0;b=l||0,(isNaN(b)||b<=0)&&(b=0)}let n=1;if(a&&a.duration&&a.duration>0&&b>0){let c="unknown";a.src&&"string"==typeof a.src?c=a.src.split("/").pop():a.currentSrc&&"string"==typeof a.currentSrc&&(c=a.currentSrc.split("/").pop());let g=a.duration/b;(g<.85||g>1.15)&&(n=g)}let h=i/n,v=0===i?0:Math.min(h/b,1);o.clearRect(0,0,$*f,x*f);let A=s,_=Math.floor($/y),S=x/2,w=A.length,E=w/_,k=Array.isArray(A[0]),q=k?1:A.scale,L=0===i,C=L?0:Math.floor(v*_);if(L||C<_){o.fillStyle=m;let P=L?0:C;for(let T=P;T<_;T++){let D=T*y,F=Math.min(Math.floor(T*E),w-1),I=0,M=0;A[F]&&(k?[I,M]=A[F]:(I=A.min[F]/q,M=A.max[F]/q));let B=Math.max(Math.abs(I),Math.abs(M)),j=Math.round(B*x),H=j/2,U=Math.round(S-H),O=Math.round(j);e2(o,D,U,d,O,4)}}if(!L&&C>0){o.fillStyle=p;for(let W=0;W<C;W++){let N=W*y,R=Math.min(Math.floor(W*E),w-1),V=0,z=0;A[R]&&(k?[V,z]=A[R]:(V=A.min[R]/q,z=A.max[R]/q));let G=Math.max(Math.abs(V),Math.abs(z)),K=Math.round(G*x),X=K/2,Y=Math.round(S-X),J=Math.round(K);e2(o,N,Y,d,J,4)}}return!0}let eD=a,e3=0;function eF(){let e=Math.ceil($/y),t=b||1;return Math.round(Math.max(50,Math.min(1e3,1e3/(e/t))))}let eI=eF(),eM=!1;a._waveformSeekingHandler&&a.removeEventListener("seeking",a._waveformSeekingHandler),a._waveformSeekedHandler&&a.removeEventListener("seeked",a._waveformSeekedHandler),a._waveformSeekingHandler=()=>{eM=!0,eT(),e3=performance.now()},a._waveformSeekedHandler=()=>{eM=!1,eT(),e3=performance.now()},a.addEventListener("seeking",a._waveformSeekingHandler),a.addEventListener("seeked",a._waveformSeekedHandler),a._waveformCurrentTimeUnsubscribe&&a._waveformCurrentTimeUnsubscribe(),a._waveformClipTimeUnsubscribe&&a._waveformClipTimeUnsubscribe(),a._waveformCurrentTimeUnsubscribe=eD.subscribe(({currentTime:e})=>{if(eD===a){let t=performance.now();(eM||t-e3>=eI)&&(eT(),e3=t)}}),a._waveformClipTimeUnsubscribe=eD.subscribe(({clipStartTime:e,clipEndTime:t})=>{if(eD===a&&u){let r=e||0,i=u?.full_duration||0,l=t||i,o=_(u,r,l,l-r);s=o.peaks,clipStart=o.clipStart,b=o.clippedDuration,eI=eF(),eT()}});let e1=r.offsetWidth,e4=t(()=>{let e=r.offsetWidth;if(80>Math.abs(e-e1))return;let t=window.devicePixelRatio||1,a=r.dataset.height?parseInt(r.dataset.height,10):26;r.width=e*t,r.height=a*t,o.scale(t,t),e1=e,lastHeight=a,$=e,x=a,eI=eF(),eT()},20),e6=new ResizeObserver(e4);e6.observe(a);let eB=(e=0)=>(0===r.offsetWidth||0===r.offsetHeight)&&(r.width=f*($||300),r.height=f*(x||50),o.scale(f,f),!l&&e<3)?(setTimeout(()=>eB(e+1),100),!1):(setTimeout(()=>{eB()},l?100:200),!0);eB()}catch(e7){console.error("Error setting up waveform:",e7)}})()}a.addEventListener("load-start",function(){O()}),O(!0)}a.hasAttribute("data-x-play-reset")&&a.addEventListener("auto-play",function(){a.setAttribute("data-x-play-reset","success"),setTimeout(()=>{a.querySelectorAll("media-play-button").forEach(e=>{e.setAttribute("aria-pressed","false"),e.removeAttribute("data-pressed")})},200),setTimeout(()=>{a.addEventListener("media-pause-request",e);function e(t){function r(e){a.muted=!1,a.currentTime=0,a.paused=!1,a.removeAttribute("data-x-play-reset"),a.removeEventListener("pause",r),setTimeout(()=>{a.setAttribute("data-x-played","true")},200)}a.addEventListener("pause",r),a.removeEventListener("media-pause-request",e)}},100)}),a.subscribe(({textTracks:e})=>{e&&0!==e.length&&e.forEach(e=>{e.label&&(e.label=e.label.replace(/\s*\(auto-generated\)/i,""))})}),d.keyboard&&(a&&a.keyShortcuts&&(d.keyboard.togglePaused&&(a.keyShortcuts.togglePaused=d.keyboard.togglePaused.split(" ")),d.keyboard.toggleMuted&&(a.keyShortcuts.toggleMuted=d.keyboard.toggleMuted.split(" ")),d.keyboard.toggleFullscreen&&(a.keyShortcuts.toggleFullscreen=d.keyboard.toggleFullscreen.split(" ")),d.keyboard.togglePictureInPicture&&(a.keyShortcuts.togglePictureInPicture=d.keyboard.togglePictureInPicture.split(" ")),d.keyboard.toggleCaptions&&(a.keyShortcuts.toggleCaptions=d.keyboard.toggleCaptions.split(" ")),d.keyboard.seekBackward&&(a.keyShortcuts.seekBackward=d.keyboard.seekBackward.split(" ")),d.keyboard.seekForward&&(a.keyShortcuts.seekForward=d.keyboard.seekForward.split(" ")),d.keyboard.volumeUp&&(a.keyShortcuts.volumeUp=d.keyboard.volumeUp.split(" ")),d.keyboard.volumeDown&&(a.keyShortcuts.volumeDown=d.keyboard.volumeDown.split(" ")),d.keyboard.speedUp&&(a.keyShortcuts.speedUp=d.keyboard.speedUp.split(" ")),d.keyboard.slowDown&&(a.keyShortcuts.slowDown=d.keyboard.slowDown.split(" "))),a.addEventListener("keydown",function(e){if(!a||"INPUT"===e.target.tagName||"TEXTAREA"===e.target.tagName)return;let t=a.playbackRate||1,r=d.keyboard&&d.keyboard.speedUp?d.keyboard.speedUp.split(" "):[">"],i=d.keyboard&&d.keyboard.slowDown?d.keyboard.slowDown.split(" "):["<"];r.includes(e.key)&&(e.preventDefault(),a.playbackRate=Math.min(2,t+.25)),i.includes(e.key)&&(e.preventDefault(),a.playbackRate=Math.max(.25,t-.25))}))})};function a(){void 0===window.xMediaPlayerTemplates&&(window.xMediaPlayerTemplates={}),document.querySelectorAll("template[data-x-mediaplayer-template]").forEach(e=>{let t=e.getAttribute("data-x-mediaplayer-template");t&&e.innerHTML&&(window.xMediaPlayerTemplates[t]=e.innerHTML,e.remove(),"function"==typeof doExtrasMediaPlayerTooltips&&doExtrasMediaPlayerTooltips(document))})}function i(e){if(a(),void 0===e.detail.queryId){if(void 0===e.detail.popupElement)return;r(e.detail.popupElement)}setTimeout(()=>{if(document.querySelector(".brxe-"+e.detail.queryId)){let t=!1;document.querySelector(".brxe-"+e.detail.queryId).querySelector(".brxe-xmediaplayer")||(t=!0),r(document.querySelector(".brxe-"+e.detail.queryId).closest(".brxe-section"),t)}else{let a=document.createTreeWalker(document.body,NodeFilter.SHOW_COMMENT,null,!1);for(;a.nextNode();){let i=a.currentNode;if(i.nodeValue.includes("brx-loop-start-"+e.detail.queryId)){let l=!1;i.parentNode.querySelector(".brxe-xmediaplayer")||(l=!0),r(i.parentNode,l);break}}}},0)}r(document),document.addEventListener("bricks/ajax/load_page/completed",i),document.addEventListener("bricks/ajax/pagination/completed",i),document.addEventListener("bricks/ajax/popup/loaded",i),document.addEventListener("bricks/ajax/end",i),window.doExtrasMediaPlayer=r}function xMediaTimer(e,t){var r,a,i=t;this.pause=function(){window.clearTimeout(r),i-=new Date-a};var l=function(){a=new Date,r=window.setTimeout(function(){i=t,l(),e()},i)};this.resume=l}function PIPMediaSessionIssue(){let e=null,t=null,r={};function a(){"undefined"!=typeof navigator&&"mediaSession"in navigator&&["play","pause","seekbackward","seekforward","previoustrack","nexttrack","seekto"].forEach(e=>{navigator.mediaSession.setActionHandler&&(r[e]=navigator.mediaSession.actionHandler?.[e])})}function i(){if("undefined"==typeof navigator||!("mediaSession"in navigator))return;let r=function r(){if(e)return e;if(t)return t;let a=document.querySelectorAll("media-player");for(let i of a)if(!i.paused)return i;return a[0]}();if(!r)return;if(function e(t){if("undefined"!=typeof navigator&&"mediaSession"in navigator&&t){let r="";r||(r=t.getAttribute("data-title")||t.title||"");let a="";a||(a=t.getAttribute("data-artist")||t.artist||"");let i=t.poster||"";try{navigator.mediaSession.metadata=null,(r||i||a)&&(navigator.mediaSession.metadata=new MediaMetadata({title:r,artist:a,artwork:i?[{src:i,sizes:"512x512",type:"image/png"}]:[]}))}catch(l){console.warn("Error setting Media Session metadata:",l)}}}(r),navigator.mediaSession.setActionHandler("play",()=>{r&&r.paused&&r.play()}),navigator.mediaSession.setActionHandler("pause",()=>{r&&!r.paused&&r.pause()}),navigator.mediaSession.setActionHandler("seekbackward",e=>{if(r){let t=e.seekOffset||10;r.currentTime=Math.max(r.currentTime-t,0)}}),navigator.mediaSession.setActionHandler("seekforward",e=>{if(r){let t=e.seekOffset||10;r.currentTime=Math.min(r.currentTime+t,r.duration||0)}}),navigator.mediaSession.setActionHandler("seekto",e=>{r&&"number"==typeof e.seekTime&&(r.currentTime=Math.max(0,Math.min(e.seekTime,r.duration||0)))}),e){navigator.mediaSession.setActionHandler("nexttrack",null),navigator.mediaSession.setActionHandler("previoustrack",null);return}let a=r.querySelector(".xmp-next");a?navigator.mediaSession.setActionHandler("nexttrack",()=>{let e=new MouseEvent("pointerdown",{bubbles:!0,cancelable:!0,view:window});a.dispatchEvent(e),setTimeout(()=>a.click(),10)}):navigator.mediaSession.setActionHandler("nexttrack",null);let i=r.querySelector(".xmp-previous");i?navigator.mediaSession.setActionHandler("previoustrack",()=>{let e=new MouseEvent("pointerdown",{bubbles:!0,cancelable:!0,view:window});i.dispatchEvent(e),setTimeout(()=>i.click(),10)}):navigator.mediaSession.setActionHandler("previoustrack",null)}function l(){let r=document.querySelectorAll("media-player");i(),r.forEach(a=>{a.addEventListener("play",()=>{t=a,e||i()}),a.addEventListener("pause",()=>{if(t===a){let l=Array.from(r).find(e=>{try{return e!==a&&e&&"object"==typeof e&&void 0!==e.paused&&(void 0===e.isConnected||!0===e.isConnected)&&!e.paused}catch(t){return!1}});l&&(t=l,e||i())}}),a.addEventListener("ended",()=>{if(t===a){t=null;let l=Array.from(r).find(e=>{try{return e!==a&&e&&"object"==typeof e&&void 0!==e.paused&&(void 0===e.isConnected||!0===e.isConnected)&&!e.paused}catch(t){return!1}});l&&(t=l,e||i())}})})}document.addEventListener("enterpictureinpicture",t=>{let r=t.target,a=r.closest("media-player");a&&(e=a,i())},!0),document.addEventListener("leavepictureinpicture",()=>{e=null,i()},!0),document.querySelector("body > .brx-body.iframe")||("loading"===document.readyState?document.addEventListener("DOMContentLoaded",l):l());let o=new MutationObserver(e=>{let t=!1;e.forEach(e=>{"childList"===e.type&&e.addedNodes.forEach(e=>{1===e.nodeType&&("MEDIA-PLAYER"===e.tagName||e.querySelector("media-player"))&&(t=!0)})}),t&&l()});document.querySelector("body > .brx-body.iframe")||o.observe(document.body,{childList:!0,subtree:!0})}document.addEventListener("DOMContentLoaded",()=>{bricksIsFrontend&&("function"==typeof processAjaxLoadedTemplates&&processAjaxLoadedTemplates(),xDoMediaPlayer())}),"undefined"!=typeof bricksextras&&(bricksextras.mediaplayer={play(e){let t=e?.target||!1;t&&(t.paused=!1)},pause(e){let t=e?.target||!1;t&&(t.paused=!0)},toggleplay(e){let t=e?.target||!1;t&&(t.paused=!t.paused)},togglemute(e){let t=e?.target||!1;t&&(t.muted=!t.muted)},enterfullscreen(e){let t=e?.target||!1;t&&t.enterFullscreen()},exitfullscreen(e){let t=e?.target||!1;t&&t.exitFullscreen()},skip(e,t){let r=e?.target||!1,a=t?parseInt(t):0;r&&(r.currentTime=a)},load(e,t=!1){let r=e?.target||!1;r&&(r.startLoading(),t&&localStorage.setItem("x-media-player","loaded"))}}),document.querySelector("body > .brx-body.iframe")||PIPMediaSessionIssue();