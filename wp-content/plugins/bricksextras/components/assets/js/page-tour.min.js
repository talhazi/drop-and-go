function xPageTour(){if(document.querySelector("body > .brx-body.iframe"))return;let e={storageKey:"x_page_tour_state",saveTourState:function(e,t){if(!window.localStorage)return!1;try{let r={tourId:e,stepIndex:t,timestamp:Date.now()};return window.localStorage.setItem(this.storageKey,JSON.stringify(r)),!0}catch(a){return!1}},getTourState:function(){if(!window.localStorage)return null;try{let e=window.localStorage.getItem(this.storageKey);if(!e)return null;return JSON.parse(e)}catch(t){return null}},clearTourState:function(){if(!window.localStorage)return!1;try{return window.localStorage.removeItem(this.storageKey),!0}catch(e){return!1}},saveCompletionState:function(e){if(!window.localStorage)return!1;try{let t=`x_page_tour_seen_${e}`;return window.localStorage.setItem(t,Date.now()),!0}catch(r){return!1}},saveCompletedState:function(e){if(!window.localStorage)return!1;try{let t=`x_page_tour_completed_${e}`;return window.localStorage.setItem(t,Date.now()),!0}catch(r){return!1}},isTourCompleted:function(e){if(!window.localStorage)return!1;try{let t=`x_page_tour_completed_${e}`;return null!==window.localStorage.getItem(t)}catch(r){return!1}},shouldShowTour:function(e,t,r,a){if(!window.localStorage)return!0;try{if("manual"===t)return!1;if("page_load"===t)return!0;let o=`x_page_tour_seen_${e}`,l=window.localStorage.getItem(o);if(!l)return!0;if("never"===t)return!1;if("until_complete"===t){if(this.isTourCompleted(e))return!1;return!0}if("after"===t){let s=parseInt(l,10),n=Date.now();return n-s>864e5*(r||0)+36e5*(a||0)}return!0}catch(i){return!0}}},t=function(t){t.querySelectorAll(".x-page-tour").forEach(t=>{if(t.hasAttribute("data-x-tour-initialized"))return;let r=JSON.parse(t.getAttribute("data-x-page-tour")),a=!0===r.rememberProgress,o=t.querySelectorAll("template.x-page-tour-step");o.length>0&&(r.steps=Array.from(o).map(e=>{let t={title:e.getAttribute("data-step-title")||"",selector:e.getAttribute("data-step-selector")||"",position:e.getAttribute("data-step-position")||"auto",highlightElement:e.hasAttribute("data-step-highlight"),scrollTo:e.hasAttribute("data-step-scroll"),text:e.innerHTML};if(e.hasAttribute("data-step-advanced"))try{t.advancedOptions=JSON.parse(e.getAttribute("data-step-advanced"))}catch(r){}return t}));let l=t.querySelectorAll(".brxe-xpagetourstep");if(l.length>0&&(r.steps=[],l.forEach((e,t)=>{let a={title:"",text:e.innerHTML,id:`step-${t}`};if(e.hasAttribute("data-step-selector")&&(a.selector=e.getAttribute("data-step-selector")),e.hasAttribute("data-step-position")&&(a.position=e.getAttribute("data-step-position")),e.hasAttribute("data-step-highlight")&&(a.highlightElement="true"===e.getAttribute("data-step-highlight")),e.hasAttribute("data-step-scroll")&&(a.scrollTo="true"===e.getAttribute("data-step-scroll")),e.hasAttribute("data-step-class")&&(a.customClass=e.getAttribute("data-step-class")),e.hasAttribute("data-step-advanced"))try{let o=JSON.parse(e.getAttribute("data-step-advanced"));a.advancedOptions=o}catch(l){}r.steps.push(a)}),l.forEach(e=>{e.style.display="none"})),!r.steps||!r.steps.length)return;let s=t.getAttribute("data-x-id"),n=t.getAttribute("id"),i=n||s,c="x-page-tour-container";t.className&&(c+=" "+t.className),r.containerClass&&(c+=" "+r.containerClass);let u=()=>{let e=document.querySelector("body > #"+i);return e||((e=document.createElement("div")).id=i,e.className=c.trim(),document.body.appendChild(e)),e},p=()=>{let e=document.getElementById(i);if(e){let t=1===e.childElementCount&&e.querySelector(".shepherd-modal-overlay-container");(0===e.childElementCount||t)&&e.remove()}},d=0;if(a&&s){let g=e.getTourState(s);g&&void 0!==g.stepIndex&&(d=g.stepIndex,g.timestamp&&Date.now()-g.timestamp>864e5&&(d=0,e.clearTourState(s)))}let h=new Shepherd.Tour({useModalOverlay:r.useModalOverlay||!1,keyboardNavigation:r.keyboardNavigation||!1,exitOnEsc:r.exitOnEsc||!1,confirmCancel:r.confirmCancel||!1,confirmCancelMessage:r.confirmCancelMessage||"Are you sure you want to exit the tour?",defaultStepOptions:{cancelIcon:{enabled:!r.disableCloseButton},canClickTarget:r.canClickTarget||!1,classes:"extras-theme",scrollTo:!1}});if(r.showProgress){let m=document.createElement("div");m.className="shepherd-progress-bar",m.setAttribute("role","progressbar"),m.setAttribute("aria-valuemin","0"),m.setAttribute("aria-valuemax","100"),m.setAttribute("aria-label","Tour progress");let x=document.createElement("div");x.className="shepherd-progress-container","top"===r.progressPosition?(x.style.top="0",x.style.bottom="auto"):(x.style.top="auto",x.style.bottom="0"),x.appendChild(m),h.on("show",e=>{setTimeout(()=>{if(e&&e.step&&e.step.el){let t=0,a=e.step.id,o=h.steps.findIndex(e=>e.id===a);t=-1!==o?o:parseInt(a.replace("step-",""))||0;let l=r.steps.length,s;s=l<=1?100:Math.max(0,Math.min(100,(t+1)/l*100));let n=`Step ${t+1} of ${l}`,i=e.step.el.querySelector(".shepherd-progress-container");i||(i=x.cloneNode(!0),e.step.el.appendChild(i));let c=i.querySelector(".shepherd-progress-bar");c&&(c.style.width=`${s}%`,c.setAttribute("aria-valuenow",Math.round(s)),c.setAttribute("aria-valuetext",n))}},0)})}r.steps.forEach((e,a)=>{let o=a===r.steps.length-1,l=[];!1!==r.navButtons&&(0!==a&&l.push({text:e.advancedOptions&&e.advancedOptions.buttonPrevText?e.advancedOptions.buttonPrevText:r.buttonPrevText||"Back",action:h.back,classes:"x-page-tour-button x-page-tour-button__back"}),o?l.push({text:e.advancedOptions&&e.advancedOptions.buttonCloseText?e.advancedOptions.buttonCloseText:r.buttonCloseText||"Finish",action:h.complete,classes:"x-page-tour-button x-page-tour-button__complete"}):l.push({text:e.advancedOptions&&e.advancedOptions.buttonNextText?e.advancedOptions.buttonNextText:r.buttonNextText||"Next",action:h.next,classes:"x-page-tour-button x-page-tour-button__next"}));let n=t.querySelectorAll("template.x-page-tour-step, .brxe-xpagetourstep"),i=n[a],c=i&&i.id?i.id:`step-${a}`,u="";i&&i.getAttribute("data-step-title")?u=i.getAttribute("data-step-title"):e.title&&(u=e.title);let p={id:c,title:u,text:e.text||"",buttons:e.advancedOptions&&!1===e.advancedOptions.showButtons||0===l.length?[]:l,modalOverlayOpeningPadding:r.modalOverlayOpeningPadding,modalOverlayOpeningRadius:r.modalOverlayOpeningRadius};p.floatingUIOptions={middleware:[{name:"offset",options:{mainAxis:100,crossAxis:100}}]};let d=n[a];if(e.selector||d){let g=!0===r.component&&r.parentComponent,m=null;if(d&&d.hasAttribute("data-target-element")){let x=d.getAttribute("data-target-element");if(x){if(g){let f=document.querySelector(`[data-x-id="${s}"]`)||t,b=f.closest(`.brxe-${r.parentComponent}`);b&&(m=b.querySelector(x))}else m=document.querySelector(x)}}if(!m&&e.selector){if(g){let $=document.querySelector(`[data-x-id="${s}"]`)||t,y=$.closest(`.brxe-${r.parentComponent}`);y&&(m=y.querySelector(e.selector))}else m=document.querySelector(e.selector)}if(p.extraHighlights=[".one",".two"],m){let S="auto";d&&d.getAttribute("data-step-position")?S=d.getAttribute("data-step-position"):e.position&&(S=e.position),p.attachTo={element:m,on:S}}else if("skip"===r.targetNotFound)return;("true"===e.highlightElement||r.defaultHighlight&&"false"!==e.highlightElement)&&(p.highlightClass="x-page-tour-highlight")}("true"===e.scrollTo||r.defaultScrollTo&&"false"!==e.scrollTo)&&(p.scrollTo={behavior:"smooth",block:"center"});let v=e.customClass||"";if(i&&i.className){let A=Array.from(i.classList).join(" ");A&&(v+=" "+A)}let T=h.addStep({...p,classes:v});i&&i.id&&T.on("show",()=>{T.el&&(T.el.id=i.id)})}),r.exitOnOverlayClick&&document.addEventListener("click",e=>{let t=e.target;for(;t;){if(t.classList&&t.classList.contains("shepherd-modal-overlay-container")){h.cancel();break}t=t.parentElement}}),void 0===window.xPageTour&&(window.xPageTour={}),void 0===window.xPageTour.Instances&&(window.xPageTour.Instances={}),s&&(window.xPageTour.Instances[s]=h);let f=t.querySelector(".x-page-tour-button");f&&f.addEventListener("click",()=>{h.start()}),h.on("start",()=>{let e=u();if(h.options.stepsContainer=e,r.useModalOverlay){let t=new MutationObserver(r=>{r.forEach(r=>{r.addedNodes.length&&r.addedNodes.forEach(r=>{r.classList&&r.classList.contains("shepherd-modal-overlay-container")&&(e.appendChild(r),t.disconnect())})})});t.observe(document.body,{childList:!0})}}),r.steps.forEach((e,t)=>{let a=0===t,o=t===r.steps.length-1;if(r.autoHideCustomButtons){let l=h.steps[t];if(l){let s=l.options.beforeShowPromise;l.options.beforeShowPromise=function(){return new Promise(e=>{let t=r.customNextSelector||".x-tour-next",l=r.customBackSelector||".x-tour-back",n=r.customCompleteSelector||".x-tour-complete",i="x-tour-button-visibility",c=document.getElementById(i);c||((c=document.createElement("style")).id=i,document.head.appendChild(c));let u="";if(a&&(u+=`${l} { display: none !important; }`),o||(u+=`${n} { display: none !important; }`),o&&(u+=`${t} { display: none !important; }`),c.textContent=u,s)return s().then(e);e()})}}}}),h.on("show",o=>{if(o&&o.step){let l=0,n=o.step.id,i=h.steps.findIndex(e=>e.id===n);l=-1!==i?i:parseInt(n.replace("step-",""))||0;let c=t.querySelectorAll("template.x-page-tour-step, .brxe-xpagetourstep"),u=c[l];if(a&&s){let p=l;e.saveTourState(s,p)}if(u){let d=new CustomEvent("x_page_tour_step:shown",{detail:{tourId:s,stepId:o.step.id,stepIndex:l},bubbles:!0});u.dispatchEvent(d),document.dispatchEvent(d)}}setTimeout(()=>{if(bricksRunAllFunctions(),o.step&&o.step.el&&o.step.el instanceof Element){"function"==typeof doExtrasMediaPlayer?doExtrasMediaPlayer(o.step.el):"function"==typeof xDoMediaPlayerLoad&&xDoMediaPlayerLoad(),xBricksExtrasElementsInit(o.step.el),o.step.el.querySelectorAll("media-player").forEach(e=>{e.hasAttribute("data-can-play")&&console.log("remove buffering")});let e=r.customNextSelector||".x-tour-next",t=r.customBackSelector||".x-tour-back",a=r.customCompleteSelector||".x-tour-complete",l=r.customSkipSelector||".x-tour-skip",s=0,n=o.step.id,i=h.steps.findIndex(e=>e.id===n);s=-1!==i?i:parseInt(n.replace("step-",""))||0,r.steps.length,o.step.el.querySelectorAll(e).forEach(t=>{t.replaceWith(t.cloneNode(!0));let r=o.step.el.querySelector(e);r&&r.addEventListener("click",()=>{h.next()})}),o.step.el.querySelectorAll(t).forEach(e=>{e.replaceWith(e.cloneNode(!0));let r=o.step.el.querySelector(t);r&&r.addEventListener("click",()=>{h.back()})}),o.step.el.querySelectorAll(a).forEach(e=>{e.replaceWith(e.cloneNode(!0));let t=o.step.el.querySelector(a);t&&t.addEventListener("click",()=>{h.complete()})}),o.step.el.querySelectorAll(l).forEach(e=>{e.replaceWith(e.cloneNode(!0));let t=o.step.el.querySelector(l);t&&t.addEventListener("click",()=>{h.cancel()})}),o.step.el.querySelectorAll("media-player").forEach(e=>{})}},100)}),h.on("hide",e=>{if(e&&e.step){let r=0,a=e.step.id,o=h.steps.findIndex(e=>e.id===a);r=-1!==o?o:parseInt(a.replace("step-",""))||0;let l=t.querySelectorAll("template.x-page-tour-step, .brxe-xpagetourstep"),n=l[r];if(n){let i=new CustomEvent("x_page_tour_step:hidden",{detail:{tourId:s,stepId:e.step.id,stepIndex:r},bubbles:!0});n.dispatchEvent(i),document.dispatchEvent(i)}}}),h.on("complete",()=>{let r=new CustomEvent("x_page_tour:completed",{detail:{tourId:s},bubbles:!0});t.dispatchEvent(r),a&&e.clearTourState(),e.saveCompletedState(s),p()}),h.on("cancel",()=>{let r=new CustomEvent("x_page_tour:cancelled",{detail:{tourId:s},bubbles:!0});t.dispatchEvent(r),a&&e.clearTourState(),p()}),h.on("start",()=>{let r=new CustomEvent("x_page_tour:started",{detail:{tourId:s},bubbles:!0});t.dispatchEvent(r),e.saveCompletionState(s)});let b="page_load"===r.trigger,$=a?e.getTourState():null,y=$&&$.tourId===s&&a,S="click"===r.trigger&&r.clickSelector,v=e.shouldShowTour(s,r.showAgain||"page_load",r.showAgainDays||0,r.showAgainHours||0),A=!0===r.component&&r.parentComponent;if(S){let T;if(A){let _=document.querySelector(`[data-x-id="${s}"]`)||t,E=_.closest(`.brxe-${r.parentComponent}`);E&&(T=E.querySelector(r.clickSelector))}else T=document.querySelector(r.clickSelector);T&&T.addEventListener("click",function(e){e.preventDefault(),h.start()})}(y||b&&v)&&setTimeout(()=>{if(y&&void 0!==$.stepIndex){let e=$.stepIndex,t="next"===r.saveNextStep,a=e;if(t&&(a=Math.min(e+1,r.steps.length-1)),a>=0){let o=h.steps[0],l=o.show,s=!1;o.show=function(){return(o.show=l,s)?l.apply(this,arguments):(s=!0,setTimeout(()=>{h.steps&&h.steps[a]?h.show(h.steps[a].id):h.show(`step-${a}`)},10),this)},h.start()}else h.start()}else b&&h.start()},500),t.setAttribute("data-x-tour-initialized","true")})};t(document),xExtrasRegisterAJAXHandler("doPageTour"),window.doPageTour=t,"undefined"!=typeof bricksextras&&(bricksextras.pagetour={start(e){let t=e?.target||!1;if(t&&t.getAttribute("data-x-id")){let r=xPageTour.Instances[t.getAttribute("data-x-id")];xPageTour&&r.start()}}})}document.addEventListener("DOMContentLoaded",function(e){bricksIsFrontend&&xPageTour()});